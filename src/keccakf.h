// Copyright Cartesi and individual authors (see AUTHORS)
// SPDX-License-Identifier: LGPL-3.0-or-later
//
// This program is free software: you can redistribute it and/or modify it under
// the terms of the GNU Lesser General Public License as published by the Free
// Software Foundation, either version 3 of the License, or (at your option) any
// later version.
//
// This program is distributed in the hope that it will be useful, but WITHOUT ANY
// WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A
// PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.
//
// You should have received a copy of the GNU Lesser General Public License along
// with this program (see COPYING). If not, see <https://www.gnu.org/licenses/>.
//

#ifndef KECCAKF_H
#define KECCAKF_H

#include <cstdint>

#include "compiler-defines.h"

namespace cartesi {

template <typename vector_type>
// NOLINTNEXTLINE(readability-function-size,hicpp-function-size,google-readability-function-size)
FORCE_INLINE static void keccakf(vector_type A[5][5]) noexcept {
    // This code is adapted from the XKCP generic64 Keccak implementation (public domain).
    // Original source:
    // https://github.com/XKCP/XKCP/blob/master/lib/low/KeccakP-1600/plain-64bits/KeccakP-1600-opt64.c
    // Selected for its 64-bit optimization, vectorization-friendly structure, branchless design, and efficient
    // memory bandwidth.
    constexpr uint64_t KECCAKF1600_ROUND_CONSTANTS[24] = {0x0000000000000001, 0x0000000000008082, 0x800000000000808a,
        0x8000000080008000, 0x000000000000808b, 0x0000000080000001, 0x8000000080008081, 0x8000000000008009,
        0x000000000000008a, 0x0000000000000088, 0x0000000080008009, 0x000000008000000a, 0x000000008000808b,
        0x800000000000008b, 0x8000000000008089, 0x8000000000008003, 0x8000000000008002, 0x8000000000000080,
        0x000000000000800a, 0x800000008000000a, 0x8000000080008081, 0x8000000000008080, 0x0000000080000001,
        0x8000000080008008};
    vector_type B[5][5];
    vector_type C[5];
    vector_type D[5];
    vector_type E[5][5];
    C[0] = A[0][0] ^ A[1][0] ^ A[2][0] ^ A[3][0] ^ A[4][0];
    C[1] = A[0][1] ^ A[1][1] ^ A[2][1] ^ A[3][1] ^ A[4][1];
    C[2] = A[0][2] ^ A[1][2] ^ A[2][2] ^ A[3][2] ^ A[4][2];
    C[3] = A[0][3] ^ A[1][3] ^ A[2][3] ^ A[3][3] ^ A[4][3];
    C[4] = A[0][4] ^ A[1][4] ^ A[2][4] ^ A[3][4] ^ A[4][4];
    D[0] = C[4] ^ (((C[1]) << 1) ^ ((C[1]) >> (64 - 1)));
    D[1] = C[0] ^ (((C[2]) << 1) ^ ((C[2]) >> (64 - 1)));
    D[2] = C[1] ^ (((C[3]) << 1) ^ ((C[3]) >> (64 - 1)));
    D[3] = C[2] ^ (((C[4]) << 1) ^ ((C[4]) >> (64 - 1)));
    D[4] = C[3] ^ (((C[0]) << 1) ^ ((C[0]) >> (64 - 1)));
    A[0][0] ^= D[0];
    B[0][0] = A[0][0];
    A[1][1] ^= D[1];
    B[0][1] = (((A[1][1]) << 44) ^ ((A[1][1]) >> (64 - 44)));
    A[2][2] ^= D[2];
    B[0][2] = (((A[2][2]) << 43) ^ ((A[2][2]) >> (64 - 43)));
    A[3][3] ^= D[3];
    B[0][3] = (((A[3][3]) << 21) ^ ((A[3][3]) >> (64 - 21)));
    A[4][4] ^= D[4];
    B[0][4] = (((A[4][4]) << 14) ^ ((A[4][4]) >> (64 - 14)));
    E[0][0] = B[0][0] ^ ((~B[0][1]) & B[0][2]);
    E[0][0] ^= KECCAKF1600_ROUND_CONSTANTS[0];
    C[0] = E[0][0];
    E[0][1] = B[0][1] ^ ((~B[0][2]) & B[0][3]);
    C[1] = E[0][1];
    E[0][2] = B[0][2] ^ ((~B[0][3]) & B[0][4]);
    C[2] = E[0][2];
    E[0][3] = B[0][3] ^ ((~B[0][4]) & B[0][0]);
    C[3] = E[0][3];
    E[0][4] = B[0][4] ^ ((~B[0][0]) & B[0][1]);
    C[4] = E[0][4];
    A[0][3] ^= D[3];
    B[1][0] = (((A[0][3]) << 28) ^ ((A[0][3]) >> (64 - 28)));
    A[1][4] ^= D[4];
    B[1][1] = (((A[1][4]) << 20) ^ ((A[1][4]) >> (64 - 20)));
    A[2][0] ^= D[0];
    B[1][2] = (((A[2][0]) << 3) ^ ((A[2][0]) >> (64 - 3)));
    A[3][1] ^= D[1];
    B[1][3] = (((A[3][1]) << 45) ^ ((A[3][1]) >> (64 - 45)));
    A[4][2] ^= D[2];
    B[1][4] = (((A[4][2]) << 61) ^ ((A[4][2]) >> (64 - 61)));
    E[1][0] = B[1][0] ^ ((~B[1][1]) & B[1][2]);
    C[0] ^= E[1][0];
    E[1][1] = B[1][1] ^ ((~B[1][2]) & B[1][3]);
    C[1] ^= E[1][1];
    E[1][2] = B[1][2] ^ ((~B[1][3]) & B[1][4]);
    C[2] ^= E[1][2];
    E[1][3] = B[1][3] ^ ((~B[1][4]) & B[1][0]);
    C[3] ^= E[1][3];
    E[1][4] = B[1][4] ^ ((~B[1][0]) & B[1][1]);
    C[4] ^= E[1][4];
    A[0][1] ^= D[1];
    B[2][0] = (((A[0][1]) << 1) ^ ((A[0][1]) >> (64 - 1)));
    A[1][2] ^= D[2];
    B[2][1] = (((A[1][2]) << 6) ^ ((A[1][2]) >> (64 - 6)));
    A[2][3] ^= D[3];
    B[2][2] = (((A[2][3]) << 25) ^ ((A[2][3]) >> (64 - 25)));
    A[3][4] ^= D[4];
    B[2][3] = (((A[3][4]) << 8) ^ ((A[3][4]) >> (64 - 8)));
    A[4][0] ^= D[0];
    B[2][4] = (((A[4][0]) << 18) ^ ((A[4][0]) >> (64 - 18)));
    E[2][0] = B[2][0] ^ ((~B[2][1]) & B[2][2]);
    C[0] ^= E[2][0];
    E[2][1] = B[2][1] ^ ((~B[2][2]) & B[2][3]);
    C[1] ^= E[2][1];
    E[2][2] = B[2][2] ^ ((~B[2][3]) & B[2][4]);
    C[2] ^= E[2][2];
    E[2][3] = B[2][3] ^ ((~B[2][4]) & B[2][0]);
    C[3] ^= E[2][3];
    E[2][4] = B[2][4] ^ ((~B[2][0]) & B[2][1]);
    C[4] ^= E[2][4];
    A[0][4] ^= D[4];
    B[3][0] = (((A[0][4]) << 27) ^ ((A[0][4]) >> (64 - 27)));
    A[1][0] ^= D[0];
    B[3][1] = (((A[1][0]) << 36) ^ ((A[1][0]) >> (64 - 36)));
    A[2][1] ^= D[1];
    B[3][2] = (((A[2][1]) << 10) ^ ((A[2][1]) >> (64 - 10)));
    A[3][2] ^= D[2];
    B[3][3] = (((A[3][2]) << 15) ^ ((A[3][2]) >> (64 - 15)));
    A[4][3] ^= D[3];
    B[3][4] = (((A[4][3]) << 56) ^ ((A[4][3]) >> (64 - 56)));
    E[3][0] = B[3][0] ^ ((~B[3][1]) & B[3][2]);
    C[0] ^= E[3][0];
    E[3][1] = B[3][1] ^ ((~B[3][2]) & B[3][3]);
    C[1] ^= E[3][1];
    E[3][2] = B[3][2] ^ ((~B[3][3]) & B[3][4]);
    C[2] ^= E[3][2];
    E[3][3] = B[3][3] ^ ((~B[3][4]) & B[3][0]);
    C[3] ^= E[3][3];
    E[3][4] = B[3][4] ^ ((~B[3][0]) & B[3][1]);
    C[4] ^= E[3][4];
    A[0][2] ^= D[2];
    B[4][0] = (((A[0][2]) << 62) ^ ((A[0][2]) >> (64 - 62)));
    A[1][3] ^= D[3];
    B[4][1] = (((A[1][3]) << 55) ^ ((A[1][3]) >> (64 - 55)));
    A[2][4] ^= D[4];
    B[4][2] = (((A[2][4]) << 39) ^ ((A[2][4]) >> (64 - 39)));
    A[3][0] ^= D[0];
    B[4][3] = (((A[3][0]) << 41) ^ ((A[3][0]) >> (64 - 41)));
    A[4][1] ^= D[1];
    B[4][4] = (((A[4][1]) << 2) ^ ((A[4][1]) >> (64 - 2)));
    E[4][0] = B[4][0] ^ ((~B[4][1]) & B[4][2]);
    C[0] ^= E[4][0];
    E[4][1] = B[4][1] ^ ((~B[4][2]) & B[4][3]);
    C[1] ^= E[4][1];
    E[4][2] = B[4][2] ^ ((~B[4][3]) & B[4][4]);
    C[2] ^= E[4][2];
    E[4][3] = B[4][3] ^ ((~B[4][4]) & B[4][0]);
    C[3] ^= E[4][3];
    E[4][4] = B[4][4] ^ ((~B[4][0]) & B[4][1]);
    C[4] ^= E[4][4];
    D[0] = C[4] ^ (((C[1]) << 1) ^ ((C[1]) >> (64 - 1)));
    D[1] = C[0] ^ (((C[2]) << 1) ^ ((C[2]) >> (64 - 1)));
    D[2] = C[1] ^ (((C[3]) << 1) ^ ((C[3]) >> (64 - 1)));
    D[3] = C[2] ^ (((C[4]) << 1) ^ ((C[4]) >> (64 - 1)));
    D[4] = C[3] ^ (((C[0]) << 1) ^ ((C[0]) >> (64 - 1)));
    E[0][0] ^= D[0];
    B[0][0] = E[0][0];
    E[1][1] ^= D[1];
    B[0][1] = (((E[1][1]) << 44) ^ ((E[1][1]) >> (64 - 44)));
    E[2][2] ^= D[2];
    B[0][2] = (((E[2][2]) << 43) ^ ((E[2][2]) >> (64 - 43)));
    E[3][3] ^= D[3];
    B[0][3] = (((E[3][3]) << 21) ^ ((E[3][3]) >> (64 - 21)));
    E[4][4] ^= D[4];
    B[0][4] = (((E[4][4]) << 14) ^ ((E[4][4]) >> (64 - 14)));
    A[0][0] = B[0][0] ^ ((~B[0][1]) & B[0][2]);
    A[0][0] ^= KECCAKF1600_ROUND_CONSTANTS[1];
    C[0] = A[0][0];
    A[0][1] = B[0][1] ^ ((~B[0][2]) & B[0][3]);
    C[1] = A[0][1];
    A[0][2] = B[0][2] ^ ((~B[0][3]) & B[0][4]);
    C[2] = A[0][2];
    A[0][3] = B[0][3] ^ ((~B[0][4]) & B[0][0]);
    C[3] = A[0][3];
    A[0][4] = B[0][4] ^ ((~B[0][0]) & B[0][1]);
    C[4] = A[0][4];
    E[0][3] ^= D[3];
    B[1][0] = (((E[0][3]) << 28) ^ ((E[0][3]) >> (64 - 28)));
    E[1][4] ^= D[4];
    B[1][1] = (((E[1][4]) << 20) ^ ((E[1][4]) >> (64 - 20)));
    E[2][0] ^= D[0];
    B[1][2] = (((E[2][0]) << 3) ^ ((E[2][0]) >> (64 - 3)));
    E[3][1] ^= D[1];
    B[1][3] = (((E[3][1]) << 45) ^ ((E[3][1]) >> (64 - 45)));
    E[4][2] ^= D[2];
    B[1][4] = (((E[4][2]) << 61) ^ ((E[4][2]) >> (64 - 61)));
    A[1][0] = B[1][0] ^ ((~B[1][1]) & B[1][2]);
    C[0] ^= A[1][0];
    A[1][1] = B[1][1] ^ ((~B[1][2]) & B[1][3]);
    C[1] ^= A[1][1];
    A[1][2] = B[1][2] ^ ((~B[1][3]) & B[1][4]);
    C[2] ^= A[1][2];
    A[1][3] = B[1][3] ^ ((~B[1][4]) & B[1][0]);
    C[3] ^= A[1][3];
    A[1][4] = B[1][4] ^ ((~B[1][0]) & B[1][1]);
    C[4] ^= A[1][4];
    E[0][1] ^= D[1];
    B[2][0] = (((E[0][1]) << 1) ^ ((E[0][1]) >> (64 - 1)));
    E[1][2] ^= D[2];
    B[2][1] = (((E[1][2]) << 6) ^ ((E[1][2]) >> (64 - 6)));
    E[2][3] ^= D[3];
    B[2][2] = (((E[2][3]) << 25) ^ ((E[2][3]) >> (64 - 25)));
    E[3][4] ^= D[4];
    B[2][3] = (((E[3][4]) << 8) ^ ((E[3][4]) >> (64 - 8)));
    E[4][0] ^= D[0];
    B[2][4] = (((E[4][0]) << 18) ^ ((E[4][0]) >> (64 - 18)));
    A[2][0] = B[2][0] ^ ((~B[2][1]) & B[2][2]);
    C[0] ^= A[2][0];
    A[2][1] = B[2][1] ^ ((~B[2][2]) & B[2][3]);
    C[1] ^= A[2][1];
    A[2][2] = B[2][2] ^ ((~B[2][3]) & B[2][4]);
    C[2] ^= A[2][2];
    A[2][3] = B[2][3] ^ ((~B[2][4]) & B[2][0]);
    C[3] ^= A[2][3];
    A[2][4] = B[2][4] ^ ((~B[2][0]) & B[2][1]);
    C[4] ^= A[2][4];
    E[0][4] ^= D[4];
    B[3][0] = (((E[0][4]) << 27) ^ ((E[0][4]) >> (64 - 27)));
    E[1][0] ^= D[0];
    B[3][1] = (((E[1][0]) << 36) ^ ((E[1][0]) >> (64 - 36)));
    E[2][1] ^= D[1];
    B[3][2] = (((E[2][1]) << 10) ^ ((E[2][1]) >> (64 - 10)));
    E[3][2] ^= D[2];
    B[3][3] = (((E[3][2]) << 15) ^ ((E[3][2]) >> (64 - 15)));
    E[4][3] ^= D[3];
    B[3][4] = (((E[4][3]) << 56) ^ ((E[4][3]) >> (64 - 56)));
    A[3][0] = B[3][0] ^ ((~B[3][1]) & B[3][2]);
    C[0] ^= A[3][0];
    A[3][1] = B[3][1] ^ ((~B[3][2]) & B[3][3]);
    C[1] ^= A[3][1];
    A[3][2] = B[3][2] ^ ((~B[3][3]) & B[3][4]);
    C[2] ^= A[3][2];
    A[3][3] = B[3][3] ^ ((~B[3][4]) & B[3][0]);
    C[3] ^= A[3][3];
    A[3][4] = B[3][4] ^ ((~B[3][0]) & B[3][1]);
    C[4] ^= A[3][4];
    E[0][2] ^= D[2];
    B[4][0] = (((E[0][2]) << 62) ^ ((E[0][2]) >> (64 - 62)));
    E[1][3] ^= D[3];
    B[4][1] = (((E[1][3]) << 55) ^ ((E[1][3]) >> (64 - 55)));
    E[2][4] ^= D[4];
    B[4][2] = (((E[2][4]) << 39) ^ ((E[2][4]) >> (64 - 39)));
    E[3][0] ^= D[0];
    B[4][3] = (((E[3][0]) << 41) ^ ((E[3][0]) >> (64 - 41)));
    E[4][1] ^= D[1];
    B[4][4] = (((E[4][1]) << 2) ^ ((E[4][1]) >> (64 - 2)));
    A[4][0] = B[4][0] ^ ((~B[4][1]) & B[4][2]);
    C[0] ^= A[4][0];
    A[4][1] = B[4][1] ^ ((~B[4][2]) & B[4][3]);
    C[1] ^= A[4][1];
    A[4][2] = B[4][2] ^ ((~B[4][3]) & B[4][4]);
    C[2] ^= A[4][2];
    A[4][3] = B[4][3] ^ ((~B[4][4]) & B[4][0]);
    C[3] ^= A[4][3];
    A[4][4] = B[4][4] ^ ((~B[4][0]) & B[4][1]);
    C[4] ^= A[4][4];
    D[0] = C[4] ^ (((C[1]) << 1) ^ ((C[1]) >> (64 - 1)));
    D[1] = C[0] ^ (((C[2]) << 1) ^ ((C[2]) >> (64 - 1)));
    D[2] = C[1] ^ (((C[3]) << 1) ^ ((C[3]) >> (64 - 1)));
    D[3] = C[2] ^ (((C[4]) << 1) ^ ((C[4]) >> (64 - 1)));
    D[4] = C[3] ^ (((C[0]) << 1) ^ ((C[0]) >> (64 - 1)));
    A[0][0] ^= D[0];
    B[0][0] = A[0][0];
    A[1][1] ^= D[1];
    B[0][1] = (((A[1][1]) << 44) ^ ((A[1][1]) >> (64 - 44)));
    A[2][2] ^= D[2];
    B[0][2] = (((A[2][2]) << 43) ^ ((A[2][2]) >> (64 - 43)));
    A[3][3] ^= D[3];
    B[0][3] = (((A[3][3]) << 21) ^ ((A[3][3]) >> (64 - 21)));
    A[4][4] ^= D[4];
    B[0][4] = (((A[4][4]) << 14) ^ ((A[4][4]) >> (64 - 14)));
    E[0][0] = B[0][0] ^ ((~B[0][1]) & B[0][2]);
    E[0][0] ^= KECCAKF1600_ROUND_CONSTANTS[2];
    C[0] = E[0][0];
    E[0][1] = B[0][1] ^ ((~B[0][2]) & B[0][3]);
    C[1] = E[0][1];
    E[0][2] = B[0][2] ^ ((~B[0][3]) & B[0][4]);
    C[2] = E[0][2];
    E[0][3] = B[0][3] ^ ((~B[0][4]) & B[0][0]);
    C[3] = E[0][3];
    E[0][4] = B[0][4] ^ ((~B[0][0]) & B[0][1]);
    C[4] = E[0][4];
    A[0][3] ^= D[3];
    B[1][0] = (((A[0][3]) << 28) ^ ((A[0][3]) >> (64 - 28)));
    A[1][4] ^= D[4];
    B[1][1] = (((A[1][4]) << 20) ^ ((A[1][4]) >> (64 - 20)));
    A[2][0] ^= D[0];
    B[1][2] = (((A[2][0]) << 3) ^ ((A[2][0]) >> (64 - 3)));
    A[3][1] ^= D[1];
    B[1][3] = (((A[3][1]) << 45) ^ ((A[3][1]) >> (64 - 45)));
    A[4][2] ^= D[2];
    B[1][4] = (((A[4][2]) << 61) ^ ((A[4][2]) >> (64 - 61)));
    E[1][0] = B[1][0] ^ ((~B[1][1]) & B[1][2]);
    C[0] ^= E[1][0];
    E[1][1] = B[1][1] ^ ((~B[1][2]) & B[1][3]);
    C[1] ^= E[1][1];
    E[1][2] = B[1][2] ^ ((~B[1][3]) & B[1][4]);
    C[2] ^= E[1][2];
    E[1][3] = B[1][3] ^ ((~B[1][4]) & B[1][0]);
    C[3] ^= E[1][3];
    E[1][4] = B[1][4] ^ ((~B[1][0]) & B[1][1]);
    C[4] ^= E[1][4];
    A[0][1] ^= D[1];
    B[2][0] = (((A[0][1]) << 1) ^ ((A[0][1]) >> (64 - 1)));
    A[1][2] ^= D[2];
    B[2][1] = (((A[1][2]) << 6) ^ ((A[1][2]) >> (64 - 6)));
    A[2][3] ^= D[3];
    B[2][2] = (((A[2][3]) << 25) ^ ((A[2][3]) >> (64 - 25)));
    A[3][4] ^= D[4];
    B[2][3] = (((A[3][4]) << 8) ^ ((A[3][4]) >> (64 - 8)));
    A[4][0] ^= D[0];
    B[2][4] = (((A[4][0]) << 18) ^ ((A[4][0]) >> (64 - 18)));
    E[2][0] = B[2][0] ^ ((~B[2][1]) & B[2][2]);
    C[0] ^= E[2][0];
    E[2][1] = B[2][1] ^ ((~B[2][2]) & B[2][3]);
    C[1] ^= E[2][1];
    E[2][2] = B[2][2] ^ ((~B[2][3]) & B[2][4]);
    C[2] ^= E[2][2];
    E[2][3] = B[2][3] ^ ((~B[2][4]) & B[2][0]);
    C[3] ^= E[2][3];
    E[2][4] = B[2][4] ^ ((~B[2][0]) & B[2][1]);
    C[4] ^= E[2][4];
    A[0][4] ^= D[4];
    B[3][0] = (((A[0][4]) << 27) ^ ((A[0][4]) >> (64 - 27)));
    A[1][0] ^= D[0];
    B[3][1] = (((A[1][0]) << 36) ^ ((A[1][0]) >> (64 - 36)));
    A[2][1] ^= D[1];
    B[3][2] = (((A[2][1]) << 10) ^ ((A[2][1]) >> (64 - 10)));
    A[3][2] ^= D[2];
    B[3][3] = (((A[3][2]) << 15) ^ ((A[3][2]) >> (64 - 15)));
    A[4][3] ^= D[3];
    B[3][4] = (((A[4][3]) << 56) ^ ((A[4][3]) >> (64 - 56)));
    E[3][0] = B[3][0] ^ ((~B[3][1]) & B[3][2]);
    C[0] ^= E[3][0];
    E[3][1] = B[3][1] ^ ((~B[3][2]) & B[3][3]);
    C[1] ^= E[3][1];
    E[3][2] = B[3][2] ^ ((~B[3][3]) & B[3][4]);
    C[2] ^= E[3][2];
    E[3][3] = B[3][3] ^ ((~B[3][4]) & B[3][0]);
    C[3] ^= E[3][3];
    E[3][4] = B[3][4] ^ ((~B[3][0]) & B[3][1]);
    C[4] ^= E[3][4];
    A[0][2] ^= D[2];
    B[4][0] = (((A[0][2]) << 62) ^ ((A[0][2]) >> (64 - 62)));
    A[1][3] ^= D[3];
    B[4][1] = (((A[1][3]) << 55) ^ ((A[1][3]) >> (64 - 55)));
    A[2][4] ^= D[4];
    B[4][2] = (((A[2][4]) << 39) ^ ((A[2][4]) >> (64 - 39)));
    A[3][0] ^= D[0];
    B[4][3] = (((A[3][0]) << 41) ^ ((A[3][0]) >> (64 - 41)));
    A[4][1] ^= D[1];
    B[4][4] = (((A[4][1]) << 2) ^ ((A[4][1]) >> (64 - 2)));
    E[4][0] = B[4][0] ^ ((~B[4][1]) & B[4][2]);
    C[0] ^= E[4][0];
    E[4][1] = B[4][1] ^ ((~B[4][2]) & B[4][3]);
    C[1] ^= E[4][1];
    E[4][2] = B[4][2] ^ ((~B[4][3]) & B[4][4]);
    C[2] ^= E[4][2];
    E[4][3] = B[4][3] ^ ((~B[4][4]) & B[4][0]);
    C[3] ^= E[4][3];
    E[4][4] = B[4][4] ^ ((~B[4][0]) & B[4][1]);
    C[4] ^= E[4][4];
    D[0] = C[4] ^ (((C[1]) << 1) ^ ((C[1]) >> (64 - 1)));
    D[1] = C[0] ^ (((C[2]) << 1) ^ ((C[2]) >> (64 - 1)));
    D[2] = C[1] ^ (((C[3]) << 1) ^ ((C[3]) >> (64 - 1)));
    D[3] = C[2] ^ (((C[4]) << 1) ^ ((C[4]) >> (64 - 1)));
    D[4] = C[3] ^ (((C[0]) << 1) ^ ((C[0]) >> (64 - 1)));
    E[0][0] ^= D[0];
    B[0][0] = E[0][0];
    E[1][1] ^= D[1];
    B[0][1] = (((E[1][1]) << 44) ^ ((E[1][1]) >> (64 - 44)));
    E[2][2] ^= D[2];
    B[0][2] = (((E[2][2]) << 43) ^ ((E[2][2]) >> (64 - 43)));
    E[3][3] ^= D[3];
    B[0][3] = (((E[3][3]) << 21) ^ ((E[3][3]) >> (64 - 21)));
    E[4][4] ^= D[4];
    B[0][4] = (((E[4][4]) << 14) ^ ((E[4][4]) >> (64 - 14)));
    A[0][0] = B[0][0] ^ ((~B[0][1]) & B[0][2]);
    A[0][0] ^= KECCAKF1600_ROUND_CONSTANTS[3];
    C[0] = A[0][0];
    A[0][1] = B[0][1] ^ ((~B[0][2]) & B[0][3]);
    C[1] = A[0][1];
    A[0][2] = B[0][2] ^ ((~B[0][3]) & B[0][4]);
    C[2] = A[0][2];
    A[0][3] = B[0][3] ^ ((~B[0][4]) & B[0][0]);
    C[3] = A[0][3];
    A[0][4] = B[0][4] ^ ((~B[0][0]) & B[0][1]);
    C[4] = A[0][4];
    E[0][3] ^= D[3];
    B[1][0] = (((E[0][3]) << 28) ^ ((E[0][3]) >> (64 - 28)));
    E[1][4] ^= D[4];
    B[1][1] = (((E[1][4]) << 20) ^ ((E[1][4]) >> (64 - 20)));
    E[2][0] ^= D[0];
    B[1][2] = (((E[2][0]) << 3) ^ ((E[2][0]) >> (64 - 3)));
    E[3][1] ^= D[1];
    B[1][3] = (((E[3][1]) << 45) ^ ((E[3][1]) >> (64 - 45)));
    E[4][2] ^= D[2];
    B[1][4] = (((E[4][2]) << 61) ^ ((E[4][2]) >> (64 - 61)));
    A[1][0] = B[1][0] ^ ((~B[1][1]) & B[1][2]);
    C[0] ^= A[1][0];
    A[1][1] = B[1][1] ^ ((~B[1][2]) & B[1][3]);
    C[1] ^= A[1][1];
    A[1][2] = B[1][2] ^ ((~B[1][3]) & B[1][4]);
    C[2] ^= A[1][2];
    A[1][3] = B[1][3] ^ ((~B[1][4]) & B[1][0]);
    C[3] ^= A[1][3];
    A[1][4] = B[1][4] ^ ((~B[1][0]) & B[1][1]);
    C[4] ^= A[1][4];
    E[0][1] ^= D[1];
    B[2][0] = (((E[0][1]) << 1) ^ ((E[0][1]) >> (64 - 1)));
    E[1][2] ^= D[2];
    B[2][1] = (((E[1][2]) << 6) ^ ((E[1][2]) >> (64 - 6)));
    E[2][3] ^= D[3];
    B[2][2] = (((E[2][3]) << 25) ^ ((E[2][3]) >> (64 - 25)));
    E[3][4] ^= D[4];
    B[2][3] = (((E[3][4]) << 8) ^ ((E[3][4]) >> (64 - 8)));
    E[4][0] ^= D[0];
    B[2][4] = (((E[4][0]) << 18) ^ ((E[4][0]) >> (64 - 18)));
    A[2][0] = B[2][0] ^ ((~B[2][1]) & B[2][2]);
    C[0] ^= A[2][0];
    A[2][1] = B[2][1] ^ ((~B[2][2]) & B[2][3]);
    C[1] ^= A[2][1];
    A[2][2] = B[2][2] ^ ((~B[2][3]) & B[2][4]);
    C[2] ^= A[2][2];
    A[2][3] = B[2][3] ^ ((~B[2][4]) & B[2][0]);
    C[3] ^= A[2][3];
    A[2][4] = B[2][4] ^ ((~B[2][0]) & B[2][1]);
    C[4] ^= A[2][4];
    E[0][4] ^= D[4];
    B[3][0] = (((E[0][4]) << 27) ^ ((E[0][4]) >> (64 - 27)));
    E[1][0] ^= D[0];
    B[3][1] = (((E[1][0]) << 36) ^ ((E[1][0]) >> (64 - 36)));
    E[2][1] ^= D[1];
    B[3][2] = (((E[2][1]) << 10) ^ ((E[2][1]) >> (64 - 10)));
    E[3][2] ^= D[2];
    B[3][3] = (((E[3][2]) << 15) ^ ((E[3][2]) >> (64 - 15)));
    E[4][3] ^= D[3];
    B[3][4] = (((E[4][3]) << 56) ^ ((E[4][3]) >> (64 - 56)));
    A[3][0] = B[3][0] ^ ((~B[3][1]) & B[3][2]);
    C[0] ^= A[3][0];
    A[3][1] = B[3][1] ^ ((~B[3][2]) & B[3][3]);
    C[1] ^= A[3][1];
    A[3][2] = B[3][2] ^ ((~B[3][3]) & B[3][4]);
    C[2] ^= A[3][2];
    A[3][3] = B[3][3] ^ ((~B[3][4]) & B[3][0]);
    C[3] ^= A[3][3];
    A[3][4] = B[3][4] ^ ((~B[3][0]) & B[3][1]);
    C[4] ^= A[3][4];
    E[0][2] ^= D[2];
    B[4][0] = (((E[0][2]) << 62) ^ ((E[0][2]) >> (64 - 62)));
    E[1][3] ^= D[3];
    B[4][1] = (((E[1][3]) << 55) ^ ((E[1][3]) >> (64 - 55)));
    E[2][4] ^= D[4];
    B[4][2] = (((E[2][4]) << 39) ^ ((E[2][4]) >> (64 - 39)));
    E[3][0] ^= D[0];
    B[4][3] = (((E[3][0]) << 41) ^ ((E[3][0]) >> (64 - 41)));
    E[4][1] ^= D[1];
    B[4][4] = (((E[4][1]) << 2) ^ ((E[4][1]) >> (64 - 2)));
    A[4][0] = B[4][0] ^ ((~B[4][1]) & B[4][2]);
    C[0] ^= A[4][0];
    A[4][1] = B[4][1] ^ ((~B[4][2]) & B[4][3]);
    C[1] ^= A[4][1];
    A[4][2] = B[4][2] ^ ((~B[4][3]) & B[4][4]);
    C[2] ^= A[4][2];
    A[4][3] = B[4][3] ^ ((~B[4][4]) & B[4][0]);
    C[3] ^= A[4][3];
    A[4][4] = B[4][4] ^ ((~B[4][0]) & B[4][1]);
    C[4] ^= A[4][4];
    D[0] = C[4] ^ (((C[1]) << 1) ^ ((C[1]) >> (64 - 1)));
    D[1] = C[0] ^ (((C[2]) << 1) ^ ((C[2]) >> (64 - 1)));
    D[2] = C[1] ^ (((C[3]) << 1) ^ ((C[3]) >> (64 - 1)));
    D[3] = C[2] ^ (((C[4]) << 1) ^ ((C[4]) >> (64 - 1)));
    D[4] = C[3] ^ (((C[0]) << 1) ^ ((C[0]) >> (64 - 1)));
    A[0][0] ^= D[0];
    B[0][0] = A[0][0];
    A[1][1] ^= D[1];
    B[0][1] = (((A[1][1]) << 44) ^ ((A[1][1]) >> (64 - 44)));
    A[2][2] ^= D[2];
    B[0][2] = (((A[2][2]) << 43) ^ ((A[2][2]) >> (64 - 43)));
    A[3][3] ^= D[3];
    B[0][3] = (((A[3][3]) << 21) ^ ((A[3][3]) >> (64 - 21)));
    A[4][4] ^= D[4];
    B[0][4] = (((A[4][4]) << 14) ^ ((A[4][4]) >> (64 - 14)));
    E[0][0] = B[0][0] ^ ((~B[0][1]) & B[0][2]);
    E[0][0] ^= KECCAKF1600_ROUND_CONSTANTS[4];
    C[0] = E[0][0];
    E[0][1] = B[0][1] ^ ((~B[0][2]) & B[0][3]);
    C[1] = E[0][1];
    E[0][2] = B[0][2] ^ ((~B[0][3]) & B[0][4]);
    C[2] = E[0][2];
    E[0][3] = B[0][3] ^ ((~B[0][4]) & B[0][0]);
    C[3] = E[0][3];
    E[0][4] = B[0][4] ^ ((~B[0][0]) & B[0][1]);
    C[4] = E[0][4];
    A[0][3] ^= D[3];
    B[1][0] = (((A[0][3]) << 28) ^ ((A[0][3]) >> (64 - 28)));
    A[1][4] ^= D[4];
    B[1][1] = (((A[1][4]) << 20) ^ ((A[1][4]) >> (64 - 20)));
    A[2][0] ^= D[0];
    B[1][2] = (((A[2][0]) << 3) ^ ((A[2][0]) >> (64 - 3)));
    A[3][1] ^= D[1];
    B[1][3] = (((A[3][1]) << 45) ^ ((A[3][1]) >> (64 - 45)));
    A[4][2] ^= D[2];
    B[1][4] = (((A[4][2]) << 61) ^ ((A[4][2]) >> (64 - 61)));
    E[1][0] = B[1][0] ^ ((~B[1][1]) & B[1][2]);
    C[0] ^= E[1][0];
    E[1][1] = B[1][1] ^ ((~B[1][2]) & B[1][3]);
    C[1] ^= E[1][1];
    E[1][2] = B[1][2] ^ ((~B[1][3]) & B[1][4]);
    C[2] ^= E[1][2];
    E[1][3] = B[1][3] ^ ((~B[1][4]) & B[1][0]);
    C[3] ^= E[1][3];
    E[1][4] = B[1][4] ^ ((~B[1][0]) & B[1][1]);
    C[4] ^= E[1][4];
    A[0][1] ^= D[1];
    B[2][0] = (((A[0][1]) << 1) ^ ((A[0][1]) >> (64 - 1)));
    A[1][2] ^= D[2];
    B[2][1] = (((A[1][2]) << 6) ^ ((A[1][2]) >> (64 - 6)));
    A[2][3] ^= D[3];
    B[2][2] = (((A[2][3]) << 25) ^ ((A[2][3]) >> (64 - 25)));
    A[3][4] ^= D[4];
    B[2][3] = (((A[3][4]) << 8) ^ ((A[3][4]) >> (64 - 8)));
    A[4][0] ^= D[0];
    B[2][4] = (((A[4][0]) << 18) ^ ((A[4][0]) >> (64 - 18)));
    E[2][0] = B[2][0] ^ ((~B[2][1]) & B[2][2]);
    C[0] ^= E[2][0];
    E[2][1] = B[2][1] ^ ((~B[2][2]) & B[2][3]);
    C[1] ^= E[2][1];
    E[2][2] = B[2][2] ^ ((~B[2][3]) & B[2][4]);
    C[2] ^= E[2][2];
    E[2][3] = B[2][3] ^ ((~B[2][4]) & B[2][0]);
    C[3] ^= E[2][3];
    E[2][4] = B[2][4] ^ ((~B[2][0]) & B[2][1]);
    C[4] ^= E[2][4];
    A[0][4] ^= D[4];
    B[3][0] = (((A[0][4]) << 27) ^ ((A[0][4]) >> (64 - 27)));
    A[1][0] ^= D[0];
    B[3][1] = (((A[1][0]) << 36) ^ ((A[1][0]) >> (64 - 36)));
    A[2][1] ^= D[1];
    B[3][2] = (((A[2][1]) << 10) ^ ((A[2][1]) >> (64 - 10)));
    A[3][2] ^= D[2];
    B[3][3] = (((A[3][2]) << 15) ^ ((A[3][2]) >> (64 - 15)));
    A[4][3] ^= D[3];
    B[3][4] = (((A[4][3]) << 56) ^ ((A[4][3]) >> (64 - 56)));
    E[3][0] = B[3][0] ^ ((~B[3][1]) & B[3][2]);
    C[0] ^= E[3][0];
    E[3][1] = B[3][1] ^ ((~B[3][2]) & B[3][3]);
    C[1] ^= E[3][1];
    E[3][2] = B[3][2] ^ ((~B[3][3]) & B[3][4]);
    C[2] ^= E[3][2];
    E[3][3] = B[3][3] ^ ((~B[3][4]) & B[3][0]);
    C[3] ^= E[3][3];
    E[3][4] = B[3][4] ^ ((~B[3][0]) & B[3][1]);
    C[4] ^= E[3][4];
    A[0][2] ^= D[2];
    B[4][0] = (((A[0][2]) << 62) ^ ((A[0][2]) >> (64 - 62)));
    A[1][3] ^= D[3];
    B[4][1] = (((A[1][3]) << 55) ^ ((A[1][3]) >> (64 - 55)));
    A[2][4] ^= D[4];
    B[4][2] = (((A[2][4]) << 39) ^ ((A[2][4]) >> (64 - 39)));
    A[3][0] ^= D[0];
    B[4][3] = (((A[3][0]) << 41) ^ ((A[3][0]) >> (64 - 41)));
    A[4][1] ^= D[1];
    B[4][4] = (((A[4][1]) << 2) ^ ((A[4][1]) >> (64 - 2)));
    E[4][0] = B[4][0] ^ ((~B[4][1]) & B[4][2]);
    C[0] ^= E[4][0];
    E[4][1] = B[4][1] ^ ((~B[4][2]) & B[4][3]);
    C[1] ^= E[4][1];
    E[4][2] = B[4][2] ^ ((~B[4][3]) & B[4][4]);
    C[2] ^= E[4][2];
    E[4][3] = B[4][3] ^ ((~B[4][4]) & B[4][0]);
    C[3] ^= E[4][3];
    E[4][4] = B[4][4] ^ ((~B[4][0]) & B[4][1]);
    C[4] ^= E[4][4];
    D[0] = C[4] ^ (((C[1]) << 1) ^ ((C[1]) >> (64 - 1)));
    D[1] = C[0] ^ (((C[2]) << 1) ^ ((C[2]) >> (64 - 1)));
    D[2] = C[1] ^ (((C[3]) << 1) ^ ((C[3]) >> (64 - 1)));
    D[3] = C[2] ^ (((C[4]) << 1) ^ ((C[4]) >> (64 - 1)));
    D[4] = C[3] ^ (((C[0]) << 1) ^ ((C[0]) >> (64 - 1)));
    E[0][0] ^= D[0];
    B[0][0] = E[0][0];
    E[1][1] ^= D[1];
    B[0][1] = (((E[1][1]) << 44) ^ ((E[1][1]) >> (64 - 44)));
    E[2][2] ^= D[2];
    B[0][2] = (((E[2][2]) << 43) ^ ((E[2][2]) >> (64 - 43)));
    E[3][3] ^= D[3];
    B[0][3] = (((E[3][3]) << 21) ^ ((E[3][3]) >> (64 - 21)));
    E[4][4] ^= D[4];
    B[0][4] = (((E[4][4]) << 14) ^ ((E[4][4]) >> (64 - 14)));
    A[0][0] = B[0][0] ^ ((~B[0][1]) & B[0][2]);
    A[0][0] ^= KECCAKF1600_ROUND_CONSTANTS[5];
    C[0] = A[0][0];
    A[0][1] = B[0][1] ^ ((~B[0][2]) & B[0][3]);
    C[1] = A[0][1];
    A[0][2] = B[0][2] ^ ((~B[0][3]) & B[0][4]);
    C[2] = A[0][2];
    A[0][3] = B[0][3] ^ ((~B[0][4]) & B[0][0]);
    C[3] = A[0][3];
    A[0][4] = B[0][4] ^ ((~B[0][0]) & B[0][1]);
    C[4] = A[0][4];
    E[0][3] ^= D[3];
    B[1][0] = (((E[0][3]) << 28) ^ ((E[0][3]) >> (64 - 28)));
    E[1][4] ^= D[4];
    B[1][1] = (((E[1][4]) << 20) ^ ((E[1][4]) >> (64 - 20)));
    E[2][0] ^= D[0];
    B[1][2] = (((E[2][0]) << 3) ^ ((E[2][0]) >> (64 - 3)));
    E[3][1] ^= D[1];
    B[1][3] = (((E[3][1]) << 45) ^ ((E[3][1]) >> (64 - 45)));
    E[4][2] ^= D[2];
    B[1][4] = (((E[4][2]) << 61) ^ ((E[4][2]) >> (64 - 61)));
    A[1][0] = B[1][0] ^ ((~B[1][1]) & B[1][2]);
    C[0] ^= A[1][0];
    A[1][1] = B[1][1] ^ ((~B[1][2]) & B[1][3]);
    C[1] ^= A[1][1];
    A[1][2] = B[1][2] ^ ((~B[1][3]) & B[1][4]);
    C[2] ^= A[1][2];
    A[1][3] = B[1][3] ^ ((~B[1][4]) & B[1][0]);
    C[3] ^= A[1][3];
    A[1][4] = B[1][4] ^ ((~B[1][0]) & B[1][1]);
    C[4] ^= A[1][4];
    E[0][1] ^= D[1];
    B[2][0] = (((E[0][1]) << 1) ^ ((E[0][1]) >> (64 - 1)));
    E[1][2] ^= D[2];
    B[2][1] = (((E[1][2]) << 6) ^ ((E[1][2]) >> (64 - 6)));
    E[2][3] ^= D[3];
    B[2][2] = (((E[2][3]) << 25) ^ ((E[2][3]) >> (64 - 25)));
    E[3][4] ^= D[4];
    B[2][3] = (((E[3][4]) << 8) ^ ((E[3][4]) >> (64 - 8)));
    E[4][0] ^= D[0];
    B[2][4] = (((E[4][0]) << 18) ^ ((E[4][0]) >> (64 - 18)));
    A[2][0] = B[2][0] ^ ((~B[2][1]) & B[2][2]);
    C[0] ^= A[2][0];
    A[2][1] = B[2][1] ^ ((~B[2][2]) & B[2][3]);
    C[1] ^= A[2][1];
    A[2][2] = B[2][2] ^ ((~B[2][3]) & B[2][4]);
    C[2] ^= A[2][2];
    A[2][3] = B[2][3] ^ ((~B[2][4]) & B[2][0]);
    C[3] ^= A[2][3];
    A[2][4] = B[2][4] ^ ((~B[2][0]) & B[2][1]);
    C[4] ^= A[2][4];
    E[0][4] ^= D[4];
    B[3][0] = (((E[0][4]) << 27) ^ ((E[0][4]) >> (64 - 27)));
    E[1][0] ^= D[0];
    B[3][1] = (((E[1][0]) << 36) ^ ((E[1][0]) >> (64 - 36)));
    E[2][1] ^= D[1];
    B[3][2] = (((E[2][1]) << 10) ^ ((E[2][1]) >> (64 - 10)));
    E[3][2] ^= D[2];
    B[3][3] = (((E[3][2]) << 15) ^ ((E[3][2]) >> (64 - 15)));
    E[4][3] ^= D[3];
    B[3][4] = (((E[4][3]) << 56) ^ ((E[4][3]) >> (64 - 56)));
    A[3][0] = B[3][0] ^ ((~B[3][1]) & B[3][2]);
    C[0] ^= A[3][0];
    A[3][1] = B[3][1] ^ ((~B[3][2]) & B[3][3]);
    C[1] ^= A[3][1];
    A[3][2] = B[3][2] ^ ((~B[3][3]) & B[3][4]);
    C[2] ^= A[3][2];
    A[3][3] = B[3][3] ^ ((~B[3][4]) & B[3][0]);
    C[3] ^= A[3][3];
    A[3][4] = B[3][4] ^ ((~B[3][0]) & B[3][1]);
    C[4] ^= A[3][4];
    E[0][2] ^= D[2];
    B[4][0] = (((E[0][2]) << 62) ^ ((E[0][2]) >> (64 - 62)));
    E[1][3] ^= D[3];
    B[4][1] = (((E[1][3]) << 55) ^ ((E[1][3]) >> (64 - 55)));
    E[2][4] ^= D[4];
    B[4][2] = (((E[2][4]) << 39) ^ ((E[2][4]) >> (64 - 39)));
    E[3][0] ^= D[0];
    B[4][3] = (((E[3][0]) << 41) ^ ((E[3][0]) >> (64 - 41)));
    E[4][1] ^= D[1];
    B[4][4] = (((E[4][1]) << 2) ^ ((E[4][1]) >> (64 - 2)));
    A[4][0] = B[4][0] ^ ((~B[4][1]) & B[4][2]);
    C[0] ^= A[4][0];
    A[4][1] = B[4][1] ^ ((~B[4][2]) & B[4][3]);
    C[1] ^= A[4][1];
    A[4][2] = B[4][2] ^ ((~B[4][3]) & B[4][4]);
    C[2] ^= A[4][2];
    A[4][3] = B[4][3] ^ ((~B[4][4]) & B[4][0]);
    C[3] ^= A[4][3];
    A[4][4] = B[4][4] ^ ((~B[4][0]) & B[4][1]);
    C[4] ^= A[4][4];
    D[0] = C[4] ^ (((C[1]) << 1) ^ ((C[1]) >> (64 - 1)));
    D[1] = C[0] ^ (((C[2]) << 1) ^ ((C[2]) >> (64 - 1)));
    D[2] = C[1] ^ (((C[3]) << 1) ^ ((C[3]) >> (64 - 1)));
    D[3] = C[2] ^ (((C[4]) << 1) ^ ((C[4]) >> (64 - 1)));
    D[4] = C[3] ^ (((C[0]) << 1) ^ ((C[0]) >> (64 - 1)));
    A[0][0] ^= D[0];
    B[0][0] = A[0][0];
    A[1][1] ^= D[1];
    B[0][1] = (((A[1][1]) << 44) ^ ((A[1][1]) >> (64 - 44)));
    A[2][2] ^= D[2];
    B[0][2] = (((A[2][2]) << 43) ^ ((A[2][2]) >> (64 - 43)));
    A[3][3] ^= D[3];
    B[0][3] = (((A[3][3]) << 21) ^ ((A[3][3]) >> (64 - 21)));
    A[4][4] ^= D[4];
    B[0][4] = (((A[4][4]) << 14) ^ ((A[4][4]) >> (64 - 14)));
    E[0][0] = B[0][0] ^ ((~B[0][1]) & B[0][2]);
    E[0][0] ^= KECCAKF1600_ROUND_CONSTANTS[6];
    C[0] = E[0][0];
    E[0][1] = B[0][1] ^ ((~B[0][2]) & B[0][3]);
    C[1] = E[0][1];
    E[0][2] = B[0][2] ^ ((~B[0][3]) & B[0][4]);
    C[2] = E[0][2];
    E[0][3] = B[0][3] ^ ((~B[0][4]) & B[0][0]);
    C[3] = E[0][3];
    E[0][4] = B[0][4] ^ ((~B[0][0]) & B[0][1]);
    C[4] = E[0][4];
    A[0][3] ^= D[3];
    B[1][0] = (((A[0][3]) << 28) ^ ((A[0][3]) >> (64 - 28)));
    A[1][4] ^= D[4];
    B[1][1] = (((A[1][4]) << 20) ^ ((A[1][4]) >> (64 - 20)));
    A[2][0] ^= D[0];
    B[1][2] = (((A[2][0]) << 3) ^ ((A[2][0]) >> (64 - 3)));
    A[3][1] ^= D[1];
    B[1][3] = (((A[3][1]) << 45) ^ ((A[3][1]) >> (64 - 45)));
    A[4][2] ^= D[2];
    B[1][4] = (((A[4][2]) << 61) ^ ((A[4][2]) >> (64 - 61)));
    E[1][0] = B[1][0] ^ ((~B[1][1]) & B[1][2]);
    C[0] ^= E[1][0];
    E[1][1] = B[1][1] ^ ((~B[1][2]) & B[1][3]);
    C[1] ^= E[1][1];
    E[1][2] = B[1][2] ^ ((~B[1][3]) & B[1][4]);
    C[2] ^= E[1][2];
    E[1][3] = B[1][3] ^ ((~B[1][4]) & B[1][0]);
    C[3] ^= E[1][3];
    E[1][4] = B[1][4] ^ ((~B[1][0]) & B[1][1]);
    C[4] ^= E[1][4];
    A[0][1] ^= D[1];
    B[2][0] = (((A[0][1]) << 1) ^ ((A[0][1]) >> (64 - 1)));
    A[1][2] ^= D[2];
    B[2][1] = (((A[1][2]) << 6) ^ ((A[1][2]) >> (64 - 6)));
    A[2][3] ^= D[3];
    B[2][2] = (((A[2][3]) << 25) ^ ((A[2][3]) >> (64 - 25)));
    A[3][4] ^= D[4];
    B[2][3] = (((A[3][4]) << 8) ^ ((A[3][4]) >> (64 - 8)));
    A[4][0] ^= D[0];
    B[2][4] = (((A[4][0]) << 18) ^ ((A[4][0]) >> (64 - 18)));
    E[2][0] = B[2][0] ^ ((~B[2][1]) & B[2][2]);
    C[0] ^= E[2][0];
    E[2][1] = B[2][1] ^ ((~B[2][2]) & B[2][3]);
    C[1] ^= E[2][1];
    E[2][2] = B[2][2] ^ ((~B[2][3]) & B[2][4]);
    C[2] ^= E[2][2];
    E[2][3] = B[2][3] ^ ((~B[2][4]) & B[2][0]);
    C[3] ^= E[2][3];
    E[2][4] = B[2][4] ^ ((~B[2][0]) & B[2][1]);
    C[4] ^= E[2][4];
    A[0][4] ^= D[4];
    B[3][0] = (((A[0][4]) << 27) ^ ((A[0][4]) >> (64 - 27)));
    A[1][0] ^= D[0];
    B[3][1] = (((A[1][0]) << 36) ^ ((A[1][0]) >> (64 - 36)));
    A[2][1] ^= D[1];
    B[3][2] = (((A[2][1]) << 10) ^ ((A[2][1]) >> (64 - 10)));
    A[3][2] ^= D[2];
    B[3][3] = (((A[3][2]) << 15) ^ ((A[3][2]) >> (64 - 15)));
    A[4][3] ^= D[3];
    B[3][4] = (((A[4][3]) << 56) ^ ((A[4][3]) >> (64 - 56)));
    E[3][0] = B[3][0] ^ ((~B[3][1]) & B[3][2]);
    C[0] ^= E[3][0];
    E[3][1] = B[3][1] ^ ((~B[3][2]) & B[3][3]);
    C[1] ^= E[3][1];
    E[3][2] = B[3][2] ^ ((~B[3][3]) & B[3][4]);
    C[2] ^= E[3][2];
    E[3][3] = B[3][3] ^ ((~B[3][4]) & B[3][0]);
    C[3] ^= E[3][3];
    E[3][4] = B[3][4] ^ ((~B[3][0]) & B[3][1]);
    C[4] ^= E[3][4];
    A[0][2] ^= D[2];
    B[4][0] = (((A[0][2]) << 62) ^ ((A[0][2]) >> (64 - 62)));
    A[1][3] ^= D[3];
    B[4][1] = (((A[1][3]) << 55) ^ ((A[1][3]) >> (64 - 55)));
    A[2][4] ^= D[4];
    B[4][2] = (((A[2][4]) << 39) ^ ((A[2][4]) >> (64 - 39)));
    A[3][0] ^= D[0];
    B[4][3] = (((A[3][0]) << 41) ^ ((A[3][0]) >> (64 - 41)));
    A[4][1] ^= D[1];
    B[4][4] = (((A[4][1]) << 2) ^ ((A[4][1]) >> (64 - 2)));
    E[4][0] = B[4][0] ^ ((~B[4][1]) & B[4][2]);
    C[0] ^= E[4][0];
    E[4][1] = B[4][1] ^ ((~B[4][2]) & B[4][3]);
    C[1] ^= E[4][1];
    E[4][2] = B[4][2] ^ ((~B[4][3]) & B[4][4]);
    C[2] ^= E[4][2];
    E[4][3] = B[4][3] ^ ((~B[4][4]) & B[4][0]);
    C[3] ^= E[4][3];
    E[4][4] = B[4][4] ^ ((~B[4][0]) & B[4][1]);
    C[4] ^= E[4][4];
    D[0] = C[4] ^ (((C[1]) << 1) ^ ((C[1]) >> (64 - 1)));
    D[1] = C[0] ^ (((C[2]) << 1) ^ ((C[2]) >> (64 - 1)));
    D[2] = C[1] ^ (((C[3]) << 1) ^ ((C[3]) >> (64 - 1)));
    D[3] = C[2] ^ (((C[4]) << 1) ^ ((C[4]) >> (64 - 1)));
    D[4] = C[3] ^ (((C[0]) << 1) ^ ((C[0]) >> (64 - 1)));
    E[0][0] ^= D[0];
    B[0][0] = E[0][0];
    E[1][1] ^= D[1];
    B[0][1] = (((E[1][1]) << 44) ^ ((E[1][1]) >> (64 - 44)));
    E[2][2] ^= D[2];
    B[0][2] = (((E[2][2]) << 43) ^ ((E[2][2]) >> (64 - 43)));
    E[3][3] ^= D[3];
    B[0][3] = (((E[3][3]) << 21) ^ ((E[3][3]) >> (64 - 21)));
    E[4][4] ^= D[4];
    B[0][4] = (((E[4][4]) << 14) ^ ((E[4][4]) >> (64 - 14)));
    A[0][0] = B[0][0] ^ ((~B[0][1]) & B[0][2]);
    A[0][0] ^= KECCAKF1600_ROUND_CONSTANTS[7];
    C[0] = A[0][0];
    A[0][1] = B[0][1] ^ ((~B[0][2]) & B[0][3]);
    C[1] = A[0][1];
    A[0][2] = B[0][2] ^ ((~B[0][3]) & B[0][4]);
    C[2] = A[0][2];
    A[0][3] = B[0][3] ^ ((~B[0][4]) & B[0][0]);
    C[3] = A[0][3];
    A[0][4] = B[0][4] ^ ((~B[0][0]) & B[0][1]);
    C[4] = A[0][4];
    E[0][3] ^= D[3];
    B[1][0] = (((E[0][3]) << 28) ^ ((E[0][3]) >> (64 - 28)));
    E[1][4] ^= D[4];
    B[1][1] = (((E[1][4]) << 20) ^ ((E[1][4]) >> (64 - 20)));
    E[2][0] ^= D[0];
    B[1][2] = (((E[2][0]) << 3) ^ ((E[2][0]) >> (64 - 3)));
    E[3][1] ^= D[1];
    B[1][3] = (((E[3][1]) << 45) ^ ((E[3][1]) >> (64 - 45)));
    E[4][2] ^= D[2];
    B[1][4] = (((E[4][2]) << 61) ^ ((E[4][2]) >> (64 - 61)));
    A[1][0] = B[1][0] ^ ((~B[1][1]) & B[1][2]);
    C[0] ^= A[1][0];
    A[1][1] = B[1][1] ^ ((~B[1][2]) & B[1][3]);
    C[1] ^= A[1][1];
    A[1][2] = B[1][2] ^ ((~B[1][3]) & B[1][4]);
    C[2] ^= A[1][2];
    A[1][3] = B[1][3] ^ ((~B[1][4]) & B[1][0]);
    C[3] ^= A[1][3];
    A[1][4] = B[1][4] ^ ((~B[1][0]) & B[1][1]);
    C[4] ^= A[1][4];
    E[0][1] ^= D[1];
    B[2][0] = (((E[0][1]) << 1) ^ ((E[0][1]) >> (64 - 1)));
    E[1][2] ^= D[2];
    B[2][1] = (((E[1][2]) << 6) ^ ((E[1][2]) >> (64 - 6)));
    E[2][3] ^= D[3];
    B[2][2] = (((E[2][3]) << 25) ^ ((E[2][3]) >> (64 - 25)));
    E[3][4] ^= D[4];
    B[2][3] = (((E[3][4]) << 8) ^ ((E[3][4]) >> (64 - 8)));
    E[4][0] ^= D[0];
    B[2][4] = (((E[4][0]) << 18) ^ ((E[4][0]) >> (64 - 18)));
    A[2][0] = B[2][0] ^ ((~B[2][1]) & B[2][2]);
    C[0] ^= A[2][0];
    A[2][1] = B[2][1] ^ ((~B[2][2]) & B[2][3]);
    C[1] ^= A[2][1];
    A[2][2] = B[2][2] ^ ((~B[2][3]) & B[2][4]);
    C[2] ^= A[2][2];
    A[2][3] = B[2][3] ^ ((~B[2][4]) & B[2][0]);
    C[3] ^= A[2][3];
    A[2][4] = B[2][4] ^ ((~B[2][0]) & B[2][1]);
    C[4] ^= A[2][4];
    E[0][4] ^= D[4];
    B[3][0] = (((E[0][4]) << 27) ^ ((E[0][4]) >> (64 - 27)));
    E[1][0] ^= D[0];
    B[3][1] = (((E[1][0]) << 36) ^ ((E[1][0]) >> (64 - 36)));
    E[2][1] ^= D[1];
    B[3][2] = (((E[2][1]) << 10) ^ ((E[2][1]) >> (64 - 10)));
    E[3][2] ^= D[2];
    B[3][3] = (((E[3][2]) << 15) ^ ((E[3][2]) >> (64 - 15)));
    E[4][3] ^= D[3];
    B[3][4] = (((E[4][3]) << 56) ^ ((E[4][3]) >> (64 - 56)));
    A[3][0] = B[3][0] ^ ((~B[3][1]) & B[3][2]);
    C[0] ^= A[3][0];
    A[3][1] = B[3][1] ^ ((~B[3][2]) & B[3][3]);
    C[1] ^= A[3][1];
    A[3][2] = B[3][2] ^ ((~B[3][3]) & B[3][4]);
    C[2] ^= A[3][2];
    A[3][3] = B[3][3] ^ ((~B[3][4]) & B[3][0]);
    C[3] ^= A[3][3];
    A[3][4] = B[3][4] ^ ((~B[3][0]) & B[3][1]);
    C[4] ^= A[3][4];
    E[0][2] ^= D[2];
    B[4][0] = (((E[0][2]) << 62) ^ ((E[0][2]) >> (64 - 62)));
    E[1][3] ^= D[3];
    B[4][1] = (((E[1][3]) << 55) ^ ((E[1][3]) >> (64 - 55)));
    E[2][4] ^= D[4];
    B[4][2] = (((E[2][4]) << 39) ^ ((E[2][4]) >> (64 - 39)));
    E[3][0] ^= D[0];
    B[4][3] = (((E[3][0]) << 41) ^ ((E[3][0]) >> (64 - 41)));
    E[4][1] ^= D[1];
    B[4][4] = (((E[4][1]) << 2) ^ ((E[4][1]) >> (64 - 2)));
    A[4][0] = B[4][0] ^ ((~B[4][1]) & B[4][2]);
    C[0] ^= A[4][0];
    A[4][1] = B[4][1] ^ ((~B[4][2]) & B[4][3]);
    C[1] ^= A[4][1];
    A[4][2] = B[4][2] ^ ((~B[4][3]) & B[4][4]);
    C[2] ^= A[4][2];
    A[4][3] = B[4][3] ^ ((~B[4][4]) & B[4][0]);
    C[3] ^= A[4][3];
    A[4][4] = B[4][4] ^ ((~B[4][0]) & B[4][1]);
    C[4] ^= A[4][4];
    D[0] = C[4] ^ (((C[1]) << 1) ^ ((C[1]) >> (64 - 1)));
    D[1] = C[0] ^ (((C[2]) << 1) ^ ((C[2]) >> (64 - 1)));
    D[2] = C[1] ^ (((C[3]) << 1) ^ ((C[3]) >> (64 - 1)));
    D[3] = C[2] ^ (((C[4]) << 1) ^ ((C[4]) >> (64 - 1)));
    D[4] = C[3] ^ (((C[0]) << 1) ^ ((C[0]) >> (64 - 1)));
    A[0][0] ^= D[0];
    B[0][0] = A[0][0];
    A[1][1] ^= D[1];
    B[0][1] = (((A[1][1]) << 44) ^ ((A[1][1]) >> (64 - 44)));
    A[2][2] ^= D[2];
    B[0][2] = (((A[2][2]) << 43) ^ ((A[2][2]) >> (64 - 43)));
    A[3][3] ^= D[3];
    B[0][3] = (((A[3][3]) << 21) ^ ((A[3][3]) >> (64 - 21)));
    A[4][4] ^= D[4];
    B[0][4] = (((A[4][4]) << 14) ^ ((A[4][4]) >> (64 - 14)));
    E[0][0] = B[0][0] ^ ((~B[0][1]) & B[0][2]);
    E[0][0] ^= KECCAKF1600_ROUND_CONSTANTS[8];
    C[0] = E[0][0];
    E[0][1] = B[0][1] ^ ((~B[0][2]) & B[0][3]);
    C[1] = E[0][1];
    E[0][2] = B[0][2] ^ ((~B[0][3]) & B[0][4]);
    C[2] = E[0][2];
    E[0][3] = B[0][3] ^ ((~B[0][4]) & B[0][0]);
    C[3] = E[0][3];
    E[0][4] = B[0][4] ^ ((~B[0][0]) & B[0][1]);
    C[4] = E[0][4];
    A[0][3] ^= D[3];
    B[1][0] = (((A[0][3]) << 28) ^ ((A[0][3]) >> (64 - 28)));
    A[1][4] ^= D[4];
    B[1][1] = (((A[1][4]) << 20) ^ ((A[1][4]) >> (64 - 20)));
    A[2][0] ^= D[0];
    B[1][2] = (((A[2][0]) << 3) ^ ((A[2][0]) >> (64 - 3)));
    A[3][1] ^= D[1];
    B[1][3] = (((A[3][1]) << 45) ^ ((A[3][1]) >> (64 - 45)));
    A[4][2] ^= D[2];
    B[1][4] = (((A[4][2]) << 61) ^ ((A[4][2]) >> (64 - 61)));
    E[1][0] = B[1][0] ^ ((~B[1][1]) & B[1][2]);
    C[0] ^= E[1][0];
    E[1][1] = B[1][1] ^ ((~B[1][2]) & B[1][3]);
    C[1] ^= E[1][1];
    E[1][2] = B[1][2] ^ ((~B[1][3]) & B[1][4]);
    C[2] ^= E[1][2];
    E[1][3] = B[1][3] ^ ((~B[1][4]) & B[1][0]);
    C[3] ^= E[1][3];
    E[1][4] = B[1][4] ^ ((~B[1][0]) & B[1][1]);
    C[4] ^= E[1][4];
    A[0][1] ^= D[1];
    B[2][0] = (((A[0][1]) << 1) ^ ((A[0][1]) >> (64 - 1)));
    A[1][2] ^= D[2];
    B[2][1] = (((A[1][2]) << 6) ^ ((A[1][2]) >> (64 - 6)));
    A[2][3] ^= D[3];
    B[2][2] = (((A[2][3]) << 25) ^ ((A[2][3]) >> (64 - 25)));
    A[3][4] ^= D[4];
    B[2][3] = (((A[3][4]) << 8) ^ ((A[3][4]) >> (64 - 8)));
    A[4][0] ^= D[0];
    B[2][4] = (((A[4][0]) << 18) ^ ((A[4][0]) >> (64 - 18)));
    E[2][0] = B[2][0] ^ ((~B[2][1]) & B[2][2]);
    C[0] ^= E[2][0];
    E[2][1] = B[2][1] ^ ((~B[2][2]) & B[2][3]);
    C[1] ^= E[2][1];
    E[2][2] = B[2][2] ^ ((~B[2][3]) & B[2][4]);
    C[2] ^= E[2][2];
    E[2][3] = B[2][3] ^ ((~B[2][4]) & B[2][0]);
    C[3] ^= E[2][3];
    E[2][4] = B[2][4] ^ ((~B[2][0]) & B[2][1]);
    C[4] ^= E[2][4];
    A[0][4] ^= D[4];
    B[3][0] = (((A[0][4]) << 27) ^ ((A[0][4]) >> (64 - 27)));
    A[1][0] ^= D[0];
    B[3][1] = (((A[1][0]) << 36) ^ ((A[1][0]) >> (64 - 36)));
    A[2][1] ^= D[1];
    B[3][2] = (((A[2][1]) << 10) ^ ((A[2][1]) >> (64 - 10)));
    A[3][2] ^= D[2];
    B[3][3] = (((A[3][2]) << 15) ^ ((A[3][2]) >> (64 - 15)));
    A[4][3] ^= D[3];
    B[3][4] = (((A[4][3]) << 56) ^ ((A[4][3]) >> (64 - 56)));
    E[3][0] = B[3][0] ^ ((~B[3][1]) & B[3][2]);
    C[0] ^= E[3][0];
    E[3][1] = B[3][1] ^ ((~B[3][2]) & B[3][3]);
    C[1] ^= E[3][1];
    E[3][2] = B[3][2] ^ ((~B[3][3]) & B[3][4]);
    C[2] ^= E[3][2];
    E[3][3] = B[3][3] ^ ((~B[3][4]) & B[3][0]);
    C[3] ^= E[3][3];
    E[3][4] = B[3][4] ^ ((~B[3][0]) & B[3][1]);
    C[4] ^= E[3][4];
    A[0][2] ^= D[2];
    B[4][0] = (((A[0][2]) << 62) ^ ((A[0][2]) >> (64 - 62)));
    A[1][3] ^= D[3];
    B[4][1] = (((A[1][3]) << 55) ^ ((A[1][3]) >> (64 - 55)));
    A[2][4] ^= D[4];
    B[4][2] = (((A[2][4]) << 39) ^ ((A[2][4]) >> (64 - 39)));
    A[3][0] ^= D[0];
    B[4][3] = (((A[3][0]) << 41) ^ ((A[3][0]) >> (64 - 41)));
    A[4][1] ^= D[1];
    B[4][4] = (((A[4][1]) << 2) ^ ((A[4][1]) >> (64 - 2)));
    E[4][0] = B[4][0] ^ ((~B[4][1]) & B[4][2]);
    C[0] ^= E[4][0];
    E[4][1] = B[4][1] ^ ((~B[4][2]) & B[4][3]);
    C[1] ^= E[4][1];
    E[4][2] = B[4][2] ^ ((~B[4][3]) & B[4][4]);
    C[2] ^= E[4][2];
    E[4][3] = B[4][3] ^ ((~B[4][4]) & B[4][0]);
    C[3] ^= E[4][3];
    E[4][4] = B[4][4] ^ ((~B[4][0]) & B[4][1]);
    C[4] ^= E[4][4];
    D[0] = C[4] ^ (((C[1]) << 1) ^ ((C[1]) >> (64 - 1)));
    D[1] = C[0] ^ (((C[2]) << 1) ^ ((C[2]) >> (64 - 1)));
    D[2] = C[1] ^ (((C[3]) << 1) ^ ((C[3]) >> (64 - 1)));
    D[3] = C[2] ^ (((C[4]) << 1) ^ ((C[4]) >> (64 - 1)));
    D[4] = C[3] ^ (((C[0]) << 1) ^ ((C[0]) >> (64 - 1)));
    E[0][0] ^= D[0];
    B[0][0] = E[0][0];
    E[1][1] ^= D[1];
    B[0][1] = (((E[1][1]) << 44) ^ ((E[1][1]) >> (64 - 44)));
    E[2][2] ^= D[2];
    B[0][2] = (((E[2][2]) << 43) ^ ((E[2][2]) >> (64 - 43)));
    E[3][3] ^= D[3];
    B[0][3] = (((E[3][3]) << 21) ^ ((E[3][3]) >> (64 - 21)));
    E[4][4] ^= D[4];
    B[0][4] = (((E[4][4]) << 14) ^ ((E[4][4]) >> (64 - 14)));
    A[0][0] = B[0][0] ^ ((~B[0][1]) & B[0][2]);
    A[0][0] ^= KECCAKF1600_ROUND_CONSTANTS[9];
    C[0] = A[0][0];
    A[0][1] = B[0][1] ^ ((~B[0][2]) & B[0][3]);
    C[1] = A[0][1];
    A[0][2] = B[0][2] ^ ((~B[0][3]) & B[0][4]);
    C[2] = A[0][2];
    A[0][3] = B[0][3] ^ ((~B[0][4]) & B[0][0]);
    C[3] = A[0][3];
    A[0][4] = B[0][4] ^ ((~B[0][0]) & B[0][1]);
    C[4] = A[0][4];
    E[0][3] ^= D[3];
    B[1][0] = (((E[0][3]) << 28) ^ ((E[0][3]) >> (64 - 28)));
    E[1][4] ^= D[4];
    B[1][1] = (((E[1][4]) << 20) ^ ((E[1][4]) >> (64 - 20)));
    E[2][0] ^= D[0];
    B[1][2] = (((E[2][0]) << 3) ^ ((E[2][0]) >> (64 - 3)));
    E[3][1] ^= D[1];
    B[1][3] = (((E[3][1]) << 45) ^ ((E[3][1]) >> (64 - 45)));
    E[4][2] ^= D[2];
    B[1][4] = (((E[4][2]) << 61) ^ ((E[4][2]) >> (64 - 61)));
    A[1][0] = B[1][0] ^ ((~B[1][1]) & B[1][2]);
    C[0] ^= A[1][0];
    A[1][1] = B[1][1] ^ ((~B[1][2]) & B[1][3]);
    C[1] ^= A[1][1];
    A[1][2] = B[1][2] ^ ((~B[1][3]) & B[1][4]);
    C[2] ^= A[1][2];
    A[1][3] = B[1][3] ^ ((~B[1][4]) & B[1][0]);
    C[3] ^= A[1][3];
    A[1][4] = B[1][4] ^ ((~B[1][0]) & B[1][1]);
    C[4] ^= A[1][4];
    E[0][1] ^= D[1];
    B[2][0] = (((E[0][1]) << 1) ^ ((E[0][1]) >> (64 - 1)));
    E[1][2] ^= D[2];
    B[2][1] = (((E[1][2]) << 6) ^ ((E[1][2]) >> (64 - 6)));
    E[2][3] ^= D[3];
    B[2][2] = (((E[2][3]) << 25) ^ ((E[2][3]) >> (64 - 25)));
    E[3][4] ^= D[4];
    B[2][3] = (((E[3][4]) << 8) ^ ((E[3][4]) >> (64 - 8)));
    E[4][0] ^= D[0];
    B[2][4] = (((E[4][0]) << 18) ^ ((E[4][0]) >> (64 - 18)));
    A[2][0] = B[2][0] ^ ((~B[2][1]) & B[2][2]);
    C[0] ^= A[2][0];
    A[2][1] = B[2][1] ^ ((~B[2][2]) & B[2][3]);
    C[1] ^= A[2][1];
    A[2][2] = B[2][2] ^ ((~B[2][3]) & B[2][4]);
    C[2] ^= A[2][2];
    A[2][3] = B[2][3] ^ ((~B[2][4]) & B[2][0]);
    C[3] ^= A[2][3];
    A[2][4] = B[2][4] ^ ((~B[2][0]) & B[2][1]);
    C[4] ^= A[2][4];
    E[0][4] ^= D[4];
    B[3][0] = (((E[0][4]) << 27) ^ ((E[0][4]) >> (64 - 27)));
    E[1][0] ^= D[0];
    B[3][1] = (((E[1][0]) << 36) ^ ((E[1][0]) >> (64 - 36)));
    E[2][1] ^= D[1];
    B[3][2] = (((E[2][1]) << 10) ^ ((E[2][1]) >> (64 - 10)));
    E[3][2] ^= D[2];
    B[3][3] = (((E[3][2]) << 15) ^ ((E[3][2]) >> (64 - 15)));
    E[4][3] ^= D[3];
    B[3][4] = (((E[4][3]) << 56) ^ ((E[4][3]) >> (64 - 56)));
    A[3][0] = B[3][0] ^ ((~B[3][1]) & B[3][2]);
    C[0] ^= A[3][0];
    A[3][1] = B[3][1] ^ ((~B[3][2]) & B[3][3]);
    C[1] ^= A[3][1];
    A[3][2] = B[3][2] ^ ((~B[3][3]) & B[3][4]);
    C[2] ^= A[3][2];
    A[3][3] = B[3][3] ^ ((~B[3][4]) & B[3][0]);
    C[3] ^= A[3][3];
    A[3][4] = B[3][4] ^ ((~B[3][0]) & B[3][1]);
    C[4] ^= A[3][4];
    E[0][2] ^= D[2];
    B[4][0] = (((E[0][2]) << 62) ^ ((E[0][2]) >> (64 - 62)));
    E[1][3] ^= D[3];
    B[4][1] = (((E[1][3]) << 55) ^ ((E[1][3]) >> (64 - 55)));
    E[2][4] ^= D[4];
    B[4][2] = (((E[2][4]) << 39) ^ ((E[2][4]) >> (64 - 39)));
    E[3][0] ^= D[0];
    B[4][3] = (((E[3][0]) << 41) ^ ((E[3][0]) >> (64 - 41)));
    E[4][1] ^= D[1];
    B[4][4] = (((E[4][1]) << 2) ^ ((E[4][1]) >> (64 - 2)));
    A[4][0] = B[4][0] ^ ((~B[4][1]) & B[4][2]);
    C[0] ^= A[4][0];
    A[4][1] = B[4][1] ^ ((~B[4][2]) & B[4][3]);
    C[1] ^= A[4][1];
    A[4][2] = B[4][2] ^ ((~B[4][3]) & B[4][4]);
    C[2] ^= A[4][2];
    A[4][3] = B[4][3] ^ ((~B[4][4]) & B[4][0]);
    C[3] ^= A[4][3];
    A[4][4] = B[4][4] ^ ((~B[4][0]) & B[4][1]);
    C[4] ^= A[4][4];
    D[0] = C[4] ^ (((C[1]) << 1) ^ ((C[1]) >> (64 - 1)));
    D[1] = C[0] ^ (((C[2]) << 1) ^ ((C[2]) >> (64 - 1)));
    D[2] = C[1] ^ (((C[3]) << 1) ^ ((C[3]) >> (64 - 1)));
    D[3] = C[2] ^ (((C[4]) << 1) ^ ((C[4]) >> (64 - 1)));
    D[4] = C[3] ^ (((C[0]) << 1) ^ ((C[0]) >> (64 - 1)));
    A[0][0] ^= D[0];
    B[0][0] = A[0][0];
    A[1][1] ^= D[1];
    B[0][1] = (((A[1][1]) << 44) ^ ((A[1][1]) >> (64 - 44)));
    A[2][2] ^= D[2];
    B[0][2] = (((A[2][2]) << 43) ^ ((A[2][2]) >> (64 - 43)));
    A[3][3] ^= D[3];
    B[0][3] = (((A[3][3]) << 21) ^ ((A[3][3]) >> (64 - 21)));
    A[4][4] ^= D[4];
    B[0][4] = (((A[4][4]) << 14) ^ ((A[4][4]) >> (64 - 14)));
    E[0][0] = B[0][0] ^ ((~B[0][1]) & B[0][2]);
    E[0][0] ^= KECCAKF1600_ROUND_CONSTANTS[10];
    C[0] = E[0][0];
    E[0][1] = B[0][1] ^ ((~B[0][2]) & B[0][3]);
    C[1] = E[0][1];
    E[0][2] = B[0][2] ^ ((~B[0][3]) & B[0][4]);
    C[2] = E[0][2];
    E[0][3] = B[0][3] ^ ((~B[0][4]) & B[0][0]);
    C[3] = E[0][3];
    E[0][4] = B[0][4] ^ ((~B[0][0]) & B[0][1]);
    C[4] = E[0][4];
    A[0][3] ^= D[3];
    B[1][0] = (((A[0][3]) << 28) ^ ((A[0][3]) >> (64 - 28)));
    A[1][4] ^= D[4];
    B[1][1] = (((A[1][4]) << 20) ^ ((A[1][4]) >> (64 - 20)));
    A[2][0] ^= D[0];
    B[1][2] = (((A[2][0]) << 3) ^ ((A[2][0]) >> (64 - 3)));
    A[3][1] ^= D[1];
    B[1][3] = (((A[3][1]) << 45) ^ ((A[3][1]) >> (64 - 45)));
    A[4][2] ^= D[2];
    B[1][4] = (((A[4][2]) << 61) ^ ((A[4][2]) >> (64 - 61)));
    E[1][0] = B[1][0] ^ ((~B[1][1]) & B[1][2]);
    C[0] ^= E[1][0];
    E[1][1] = B[1][1] ^ ((~B[1][2]) & B[1][3]);
    C[1] ^= E[1][1];
    E[1][2] = B[1][2] ^ ((~B[1][3]) & B[1][4]);
    C[2] ^= E[1][2];
    E[1][3] = B[1][3] ^ ((~B[1][4]) & B[1][0]);
    C[3] ^= E[1][3];
    E[1][4] = B[1][4] ^ ((~B[1][0]) & B[1][1]);
    C[4] ^= E[1][4];
    A[0][1] ^= D[1];
    B[2][0] = (((A[0][1]) << 1) ^ ((A[0][1]) >> (64 - 1)));
    A[1][2] ^= D[2];
    B[2][1] = (((A[1][2]) << 6) ^ ((A[1][2]) >> (64 - 6)));
    A[2][3] ^= D[3];
    B[2][2] = (((A[2][3]) << 25) ^ ((A[2][3]) >> (64 - 25)));
    A[3][4] ^= D[4];
    B[2][3] = (((A[3][4]) << 8) ^ ((A[3][4]) >> (64 - 8)));
    A[4][0] ^= D[0];
    B[2][4] = (((A[4][0]) << 18) ^ ((A[4][0]) >> (64 - 18)));
    E[2][0] = B[2][0] ^ ((~B[2][1]) & B[2][2]);
    C[0] ^= E[2][0];
    E[2][1] = B[2][1] ^ ((~B[2][2]) & B[2][3]);
    C[1] ^= E[2][1];
    E[2][2] = B[2][2] ^ ((~B[2][3]) & B[2][4]);
    C[2] ^= E[2][2];
    E[2][3] = B[2][3] ^ ((~B[2][4]) & B[2][0]);
    C[3] ^= E[2][3];
    E[2][4] = B[2][4] ^ ((~B[2][0]) & B[2][1]);
    C[4] ^= E[2][4];
    A[0][4] ^= D[4];
    B[3][0] = (((A[0][4]) << 27) ^ ((A[0][4]) >> (64 - 27)));
    A[1][0] ^= D[0];
    B[3][1] = (((A[1][0]) << 36) ^ ((A[1][0]) >> (64 - 36)));
    A[2][1] ^= D[1];
    B[3][2] = (((A[2][1]) << 10) ^ ((A[2][1]) >> (64 - 10)));
    A[3][2] ^= D[2];
    B[3][3] = (((A[3][2]) << 15) ^ ((A[3][2]) >> (64 - 15)));
    A[4][3] ^= D[3];
    B[3][4] = (((A[4][3]) << 56) ^ ((A[4][3]) >> (64 - 56)));
    E[3][0] = B[3][0] ^ ((~B[3][1]) & B[3][2]);
    C[0] ^= E[3][0];
    E[3][1] = B[3][1] ^ ((~B[3][2]) & B[3][3]);
    C[1] ^= E[3][1];
    E[3][2] = B[3][2] ^ ((~B[3][3]) & B[3][4]);
    C[2] ^= E[3][2];
    E[3][3] = B[3][3] ^ ((~B[3][4]) & B[3][0]);
    C[3] ^= E[3][3];
    E[3][4] = B[3][4] ^ ((~B[3][0]) & B[3][1]);
    C[4] ^= E[3][4];
    A[0][2] ^= D[2];
    B[4][0] = (((A[0][2]) << 62) ^ ((A[0][2]) >> (64 - 62)));
    A[1][3] ^= D[3];
    B[4][1] = (((A[1][3]) << 55) ^ ((A[1][3]) >> (64 - 55)));
    A[2][4] ^= D[4];
    B[4][2] = (((A[2][4]) << 39) ^ ((A[2][4]) >> (64 - 39)));
    A[3][0] ^= D[0];
    B[4][3] = (((A[3][0]) << 41) ^ ((A[3][0]) >> (64 - 41)));
    A[4][1] ^= D[1];
    B[4][4] = (((A[4][1]) << 2) ^ ((A[4][1]) >> (64 - 2)));
    E[4][0] = B[4][0] ^ ((~B[4][1]) & B[4][2]);
    C[0] ^= E[4][0];
    E[4][1] = B[4][1] ^ ((~B[4][2]) & B[4][3]);
    C[1] ^= E[4][1];
    E[4][2] = B[4][2] ^ ((~B[4][3]) & B[4][4]);
    C[2] ^= E[4][2];
    E[4][3] = B[4][3] ^ ((~B[4][4]) & B[4][0]);
    C[3] ^= E[4][3];
    E[4][4] = B[4][4] ^ ((~B[4][0]) & B[4][1]);
    C[4] ^= E[4][4];
    D[0] = C[4] ^ (((C[1]) << 1) ^ ((C[1]) >> (64 - 1)));
    D[1] = C[0] ^ (((C[2]) << 1) ^ ((C[2]) >> (64 - 1)));
    D[2] = C[1] ^ (((C[3]) << 1) ^ ((C[3]) >> (64 - 1)));
    D[3] = C[2] ^ (((C[4]) << 1) ^ ((C[4]) >> (64 - 1)));
    D[4] = C[3] ^ (((C[0]) << 1) ^ ((C[0]) >> (64 - 1)));
    E[0][0] ^= D[0];
    B[0][0] = E[0][0];
    E[1][1] ^= D[1];
    B[0][1] = (((E[1][1]) << 44) ^ ((E[1][1]) >> (64 - 44)));
    E[2][2] ^= D[2];
    B[0][2] = (((E[2][2]) << 43) ^ ((E[2][2]) >> (64 - 43)));
    E[3][3] ^= D[3];
    B[0][3] = (((E[3][3]) << 21) ^ ((E[3][3]) >> (64 - 21)));
    E[4][4] ^= D[4];
    B[0][4] = (((E[4][4]) << 14) ^ ((E[4][4]) >> (64 - 14)));
    A[0][0] = B[0][0] ^ ((~B[0][1]) & B[0][2]);
    A[0][0] ^= KECCAKF1600_ROUND_CONSTANTS[11];
    C[0] = A[0][0];
    A[0][1] = B[0][1] ^ ((~B[0][2]) & B[0][3]);
    C[1] = A[0][1];
    A[0][2] = B[0][2] ^ ((~B[0][3]) & B[0][4]);
    C[2] = A[0][2];
    A[0][3] = B[0][3] ^ ((~B[0][4]) & B[0][0]);
    C[3] = A[0][3];
    A[0][4] = B[0][4] ^ ((~B[0][0]) & B[0][1]);
    C[4] = A[0][4];
    E[0][3] ^= D[3];
    B[1][0] = (((E[0][3]) << 28) ^ ((E[0][3]) >> (64 - 28)));
    E[1][4] ^= D[4];
    B[1][1] = (((E[1][4]) << 20) ^ ((E[1][4]) >> (64 - 20)));
    E[2][0] ^= D[0];
    B[1][2] = (((E[2][0]) << 3) ^ ((E[2][0]) >> (64 - 3)));
    E[3][1] ^= D[1];
    B[1][3] = (((E[3][1]) << 45) ^ ((E[3][1]) >> (64 - 45)));
    E[4][2] ^= D[2];
    B[1][4] = (((E[4][2]) << 61) ^ ((E[4][2]) >> (64 - 61)));
    A[1][0] = B[1][0] ^ ((~B[1][1]) & B[1][2]);
    C[0] ^= A[1][0];
    A[1][1] = B[1][1] ^ ((~B[1][2]) & B[1][3]);
    C[1] ^= A[1][1];
    A[1][2] = B[1][2] ^ ((~B[1][3]) & B[1][4]);
    C[2] ^= A[1][2];
    A[1][3] = B[1][3] ^ ((~B[1][4]) & B[1][0]);
    C[3] ^= A[1][3];
    A[1][4] = B[1][4] ^ ((~B[1][0]) & B[1][1]);
    C[4] ^= A[1][4];
    E[0][1] ^= D[1];
    B[2][0] = (((E[0][1]) << 1) ^ ((E[0][1]) >> (64 - 1)));
    E[1][2] ^= D[2];
    B[2][1] = (((E[1][2]) << 6) ^ ((E[1][2]) >> (64 - 6)));
    E[2][3] ^= D[3];
    B[2][2] = (((E[2][3]) << 25) ^ ((E[2][3]) >> (64 - 25)));
    E[3][4] ^= D[4];
    B[2][3] = (((E[3][4]) << 8) ^ ((E[3][4]) >> (64 - 8)));
    E[4][0] ^= D[0];
    B[2][4] = (((E[4][0]) << 18) ^ ((E[4][0]) >> (64 - 18)));
    A[2][0] = B[2][0] ^ ((~B[2][1]) & B[2][2]);
    C[0] ^= A[2][0];
    A[2][1] = B[2][1] ^ ((~B[2][2]) & B[2][3]);
    C[1] ^= A[2][1];
    A[2][2] = B[2][2] ^ ((~B[2][3]) & B[2][4]);
    C[2] ^= A[2][2];
    A[2][3] = B[2][3] ^ ((~B[2][4]) & B[2][0]);
    C[3] ^= A[2][3];
    A[2][4] = B[2][4] ^ ((~B[2][0]) & B[2][1]);
    C[4] ^= A[2][4];
    E[0][4] ^= D[4];
    B[3][0] = (((E[0][4]) << 27) ^ ((E[0][4]) >> (64 - 27)));
    E[1][0] ^= D[0];
    B[3][1] = (((E[1][0]) << 36) ^ ((E[1][0]) >> (64 - 36)));
    E[2][1] ^= D[1];
    B[3][2] = (((E[2][1]) << 10) ^ ((E[2][1]) >> (64 - 10)));
    E[3][2] ^= D[2];
    B[3][3] = (((E[3][2]) << 15) ^ ((E[3][2]) >> (64 - 15)));
    E[4][3] ^= D[3];
    B[3][4] = (((E[4][3]) << 56) ^ ((E[4][3]) >> (64 - 56)));
    A[3][0] = B[3][0] ^ ((~B[3][1]) & B[3][2]);
    C[0] ^= A[3][0];
    A[3][1] = B[3][1] ^ ((~B[3][2]) & B[3][3]);
    C[1] ^= A[3][1];
    A[3][2] = B[3][2] ^ ((~B[3][3]) & B[3][4]);
    C[2] ^= A[3][2];
    A[3][3] = B[3][3] ^ ((~B[3][4]) & B[3][0]);
    C[3] ^= A[3][3];
    A[3][4] = B[3][4] ^ ((~B[3][0]) & B[3][1]);
    C[4] ^= A[3][4];
    E[0][2] ^= D[2];
    B[4][0] = (((E[0][2]) << 62) ^ ((E[0][2]) >> (64 - 62)));
    E[1][3] ^= D[3];
    B[4][1] = (((E[1][3]) << 55) ^ ((E[1][3]) >> (64 - 55)));
    E[2][4] ^= D[4];
    B[4][2] = (((E[2][4]) << 39) ^ ((E[2][4]) >> (64 - 39)));
    E[3][0] ^= D[0];
    B[4][3] = (((E[3][0]) << 41) ^ ((E[3][0]) >> (64 - 41)));
    E[4][1] ^= D[1];
    B[4][4] = (((E[4][1]) << 2) ^ ((E[4][1]) >> (64 - 2)));
    A[4][0] = B[4][0] ^ ((~B[4][1]) & B[4][2]);
    C[0] ^= A[4][0];
    A[4][1] = B[4][1] ^ ((~B[4][2]) & B[4][3]);
    C[1] ^= A[4][1];
    A[4][2] = B[4][2] ^ ((~B[4][3]) & B[4][4]);
    C[2] ^= A[4][2];
    A[4][3] = B[4][3] ^ ((~B[4][4]) & B[4][0]);
    C[3] ^= A[4][3];
    A[4][4] = B[4][4] ^ ((~B[4][0]) & B[4][1]);
    C[4] ^= A[4][4];
    D[0] = C[4] ^ (((C[1]) << 1) ^ ((C[1]) >> (64 - 1)));
    D[1] = C[0] ^ (((C[2]) << 1) ^ ((C[2]) >> (64 - 1)));
    D[2] = C[1] ^ (((C[3]) << 1) ^ ((C[3]) >> (64 - 1)));
    D[3] = C[2] ^ (((C[4]) << 1) ^ ((C[4]) >> (64 - 1)));
    D[4] = C[3] ^ (((C[0]) << 1) ^ ((C[0]) >> (64 - 1)));
    A[0][0] ^= D[0];
    B[0][0] = A[0][0];
    A[1][1] ^= D[1];
    B[0][1] = (((A[1][1]) << 44) ^ ((A[1][1]) >> (64 - 44)));
    A[2][2] ^= D[2];
    B[0][2] = (((A[2][2]) << 43) ^ ((A[2][2]) >> (64 - 43)));
    A[3][3] ^= D[3];
    B[0][3] = (((A[3][3]) << 21) ^ ((A[3][3]) >> (64 - 21)));
    A[4][4] ^= D[4];
    B[0][4] = (((A[4][4]) << 14) ^ ((A[4][4]) >> (64 - 14)));
    E[0][0] = B[0][0] ^ ((~B[0][1]) & B[0][2]);
    E[0][0] ^= KECCAKF1600_ROUND_CONSTANTS[12];
    C[0] = E[0][0];
    E[0][1] = B[0][1] ^ ((~B[0][2]) & B[0][3]);
    C[1] = E[0][1];
    E[0][2] = B[0][2] ^ ((~B[0][3]) & B[0][4]);
    C[2] = E[0][2];
    E[0][3] = B[0][3] ^ ((~B[0][4]) & B[0][0]);
    C[3] = E[0][3];
    E[0][4] = B[0][4] ^ ((~B[0][0]) & B[0][1]);
    C[4] = E[0][4];
    A[0][3] ^= D[3];
    B[1][0] = (((A[0][3]) << 28) ^ ((A[0][3]) >> (64 - 28)));
    A[1][4] ^= D[4];
    B[1][1] = (((A[1][4]) << 20) ^ ((A[1][4]) >> (64 - 20)));
    A[2][0] ^= D[0];
    B[1][2] = (((A[2][0]) << 3) ^ ((A[2][0]) >> (64 - 3)));
    A[3][1] ^= D[1];
    B[1][3] = (((A[3][1]) << 45) ^ ((A[3][1]) >> (64 - 45)));
    A[4][2] ^= D[2];
    B[1][4] = (((A[4][2]) << 61) ^ ((A[4][2]) >> (64 - 61)));
    E[1][0] = B[1][0] ^ ((~B[1][1]) & B[1][2]);
    C[0] ^= E[1][0];
    E[1][1] = B[1][1] ^ ((~B[1][2]) & B[1][3]);
    C[1] ^= E[1][1];
    E[1][2] = B[1][2] ^ ((~B[1][3]) & B[1][4]);
    C[2] ^= E[1][2];
    E[1][3] = B[1][3] ^ ((~B[1][4]) & B[1][0]);
    C[3] ^= E[1][3];
    E[1][4] = B[1][4] ^ ((~B[1][0]) & B[1][1]);
    C[4] ^= E[1][4];
    A[0][1] ^= D[1];
    B[2][0] = (((A[0][1]) << 1) ^ ((A[0][1]) >> (64 - 1)));
    A[1][2] ^= D[2];
    B[2][1] = (((A[1][2]) << 6) ^ ((A[1][2]) >> (64 - 6)));
    A[2][3] ^= D[3];
    B[2][2] = (((A[2][3]) << 25) ^ ((A[2][3]) >> (64 - 25)));
    A[3][4] ^= D[4];
    B[2][3] = (((A[3][4]) << 8) ^ ((A[3][4]) >> (64 - 8)));
    A[4][0] ^= D[0];
    B[2][4] = (((A[4][0]) << 18) ^ ((A[4][0]) >> (64 - 18)));
    E[2][0] = B[2][0] ^ ((~B[2][1]) & B[2][2]);
    C[0] ^= E[2][0];
    E[2][1] = B[2][1] ^ ((~B[2][2]) & B[2][3]);
    C[1] ^= E[2][1];
    E[2][2] = B[2][2] ^ ((~B[2][3]) & B[2][4]);
    C[2] ^= E[2][2];
    E[2][3] = B[2][3] ^ ((~B[2][4]) & B[2][0]);
    C[3] ^= E[2][3];
    E[2][4] = B[2][4] ^ ((~B[2][0]) & B[2][1]);
    C[4] ^= E[2][4];
    A[0][4] ^= D[4];
    B[3][0] = (((A[0][4]) << 27) ^ ((A[0][4]) >> (64 - 27)));
    A[1][0] ^= D[0];
    B[3][1] = (((A[1][0]) << 36) ^ ((A[1][0]) >> (64 - 36)));
    A[2][1] ^= D[1];
    B[3][2] = (((A[2][1]) << 10) ^ ((A[2][1]) >> (64 - 10)));
    A[3][2] ^= D[2];
    B[3][3] = (((A[3][2]) << 15) ^ ((A[3][2]) >> (64 - 15)));
    A[4][3] ^= D[3];
    B[3][4] = (((A[4][3]) << 56) ^ ((A[4][3]) >> (64 - 56)));
    E[3][0] = B[3][0] ^ ((~B[3][1]) & B[3][2]);
    C[0] ^= E[3][0];
    E[3][1] = B[3][1] ^ ((~B[3][2]) & B[3][3]);
    C[1] ^= E[3][1];
    E[3][2] = B[3][2] ^ ((~B[3][3]) & B[3][4]);
    C[2] ^= E[3][2];
    E[3][3] = B[3][3] ^ ((~B[3][4]) & B[3][0]);
    C[3] ^= E[3][3];
    E[3][4] = B[3][4] ^ ((~B[3][0]) & B[3][1]);
    C[4] ^= E[3][4];
    A[0][2] ^= D[2];
    B[4][0] = (((A[0][2]) << 62) ^ ((A[0][2]) >> (64 - 62)));
    A[1][3] ^= D[3];
    B[4][1] = (((A[1][3]) << 55) ^ ((A[1][3]) >> (64 - 55)));
    A[2][4] ^= D[4];
    B[4][2] = (((A[2][4]) << 39) ^ ((A[2][4]) >> (64 - 39)));
    A[3][0] ^= D[0];
    B[4][3] = (((A[3][0]) << 41) ^ ((A[3][0]) >> (64 - 41)));
    A[4][1] ^= D[1];
    B[4][4] = (((A[4][1]) << 2) ^ ((A[4][1]) >> (64 - 2)));
    E[4][0] = B[4][0] ^ ((~B[4][1]) & B[4][2]);
    C[0] ^= E[4][0];
    E[4][1] = B[4][1] ^ ((~B[4][2]) & B[4][3]);
    C[1] ^= E[4][1];
    E[4][2] = B[4][2] ^ ((~B[4][3]) & B[4][4]);
    C[2] ^= E[4][2];
    E[4][3] = B[4][3] ^ ((~B[4][4]) & B[4][0]);
    C[3] ^= E[4][3];
    E[4][4] = B[4][4] ^ ((~B[4][0]) & B[4][1]);
    C[4] ^= E[4][4];
    D[0] = C[4] ^ (((C[1]) << 1) ^ ((C[1]) >> (64 - 1)));
    D[1] = C[0] ^ (((C[2]) << 1) ^ ((C[2]) >> (64 - 1)));
    D[2] = C[1] ^ (((C[3]) << 1) ^ ((C[3]) >> (64 - 1)));
    D[3] = C[2] ^ (((C[4]) << 1) ^ ((C[4]) >> (64 - 1)));
    D[4] = C[3] ^ (((C[0]) << 1) ^ ((C[0]) >> (64 - 1)));
    E[0][0] ^= D[0];
    B[0][0] = E[0][0];
    E[1][1] ^= D[1];
    B[0][1] = (((E[1][1]) << 44) ^ ((E[1][1]) >> (64 - 44)));
    E[2][2] ^= D[2];
    B[0][2] = (((E[2][2]) << 43) ^ ((E[2][2]) >> (64 - 43)));
    E[3][3] ^= D[3];
    B[0][3] = (((E[3][3]) << 21) ^ ((E[3][3]) >> (64 - 21)));
    E[4][4] ^= D[4];
    B[0][4] = (((E[4][4]) << 14) ^ ((E[4][4]) >> (64 - 14)));
    A[0][0] = B[0][0] ^ ((~B[0][1]) & B[0][2]);
    A[0][0] ^= KECCAKF1600_ROUND_CONSTANTS[13];
    C[0] = A[0][0];
    A[0][1] = B[0][1] ^ ((~B[0][2]) & B[0][3]);
    C[1] = A[0][1];
    A[0][2] = B[0][2] ^ ((~B[0][3]) & B[0][4]);
    C[2] = A[0][2];
    A[0][3] = B[0][3] ^ ((~B[0][4]) & B[0][0]);
    C[3] = A[0][3];
    A[0][4] = B[0][4] ^ ((~B[0][0]) & B[0][1]);
    C[4] = A[0][4];
    E[0][3] ^= D[3];
    B[1][0] = (((E[0][3]) << 28) ^ ((E[0][3]) >> (64 - 28)));
    E[1][4] ^= D[4];
    B[1][1] = (((E[1][4]) << 20) ^ ((E[1][4]) >> (64 - 20)));
    E[2][0] ^= D[0];
    B[1][2] = (((E[2][0]) << 3) ^ ((E[2][0]) >> (64 - 3)));
    E[3][1] ^= D[1];
    B[1][3] = (((E[3][1]) << 45) ^ ((E[3][1]) >> (64 - 45)));
    E[4][2] ^= D[2];
    B[1][4] = (((E[4][2]) << 61) ^ ((E[4][2]) >> (64 - 61)));
    A[1][0] = B[1][0] ^ ((~B[1][1]) & B[1][2]);
    C[0] ^= A[1][0];
    A[1][1] = B[1][1] ^ ((~B[1][2]) & B[1][3]);
    C[1] ^= A[1][1];
    A[1][2] = B[1][2] ^ ((~B[1][3]) & B[1][4]);
    C[2] ^= A[1][2];
    A[1][3] = B[1][3] ^ ((~B[1][4]) & B[1][0]);
    C[3] ^= A[1][3];
    A[1][4] = B[1][4] ^ ((~B[1][0]) & B[1][1]);
    C[4] ^= A[1][4];
    E[0][1] ^= D[1];
    B[2][0] = (((E[0][1]) << 1) ^ ((E[0][1]) >> (64 - 1)));
    E[1][2] ^= D[2];
    B[2][1] = (((E[1][2]) << 6) ^ ((E[1][2]) >> (64 - 6)));
    E[2][3] ^= D[3];
    B[2][2] = (((E[2][3]) << 25) ^ ((E[2][3]) >> (64 - 25)));
    E[3][4] ^= D[4];
    B[2][3] = (((E[3][4]) << 8) ^ ((E[3][4]) >> (64 - 8)));
    E[4][0] ^= D[0];
    B[2][4] = (((E[4][0]) << 18) ^ ((E[4][0]) >> (64 - 18)));
    A[2][0] = B[2][0] ^ ((~B[2][1]) & B[2][2]);
    C[0] ^= A[2][0];
    A[2][1] = B[2][1] ^ ((~B[2][2]) & B[2][3]);
    C[1] ^= A[2][1];
    A[2][2] = B[2][2] ^ ((~B[2][3]) & B[2][4]);
    C[2] ^= A[2][2];
    A[2][3] = B[2][3] ^ ((~B[2][4]) & B[2][0]);
    C[3] ^= A[2][3];
    A[2][4] = B[2][4] ^ ((~B[2][0]) & B[2][1]);
    C[4] ^= A[2][4];
    E[0][4] ^= D[4];
    B[3][0] = (((E[0][4]) << 27) ^ ((E[0][4]) >> (64 - 27)));
    E[1][0] ^= D[0];
    B[3][1] = (((E[1][0]) << 36) ^ ((E[1][0]) >> (64 - 36)));
    E[2][1] ^= D[1];
    B[3][2] = (((E[2][1]) << 10) ^ ((E[2][1]) >> (64 - 10)));
    E[3][2] ^= D[2];
    B[3][3] = (((E[3][2]) << 15) ^ ((E[3][2]) >> (64 - 15)));
    E[4][3] ^= D[3];
    B[3][4] = (((E[4][3]) << 56) ^ ((E[4][3]) >> (64 - 56)));
    A[3][0] = B[3][0] ^ ((~B[3][1]) & B[3][2]);
    C[0] ^= A[3][0];
    A[3][1] = B[3][1] ^ ((~B[3][2]) & B[3][3]);
    C[1] ^= A[3][1];
    A[3][2] = B[3][2] ^ ((~B[3][3]) & B[3][4]);
    C[2] ^= A[3][2];
    A[3][3] = B[3][3] ^ ((~B[3][4]) & B[3][0]);
    C[3] ^= A[3][3];
    A[3][4] = B[3][4] ^ ((~B[3][0]) & B[3][1]);
    C[4] ^= A[3][4];
    E[0][2] ^= D[2];
    B[4][0] = (((E[0][2]) << 62) ^ ((E[0][2]) >> (64 - 62)));
    E[1][3] ^= D[3];
    B[4][1] = (((E[1][3]) << 55) ^ ((E[1][3]) >> (64 - 55)));
    E[2][4] ^= D[4];
    B[4][2] = (((E[2][4]) << 39) ^ ((E[2][4]) >> (64 - 39)));
    E[3][0] ^= D[0];
    B[4][3] = (((E[3][0]) << 41) ^ ((E[3][0]) >> (64 - 41)));
    E[4][1] ^= D[1];
    B[4][4] = (((E[4][1]) << 2) ^ ((E[4][1]) >> (64 - 2)));
    A[4][0] = B[4][0] ^ ((~B[4][1]) & B[4][2]);
    C[0] ^= A[4][0];
    A[4][1] = B[4][1] ^ ((~B[4][2]) & B[4][3]);
    C[1] ^= A[4][1];
    A[4][2] = B[4][2] ^ ((~B[4][3]) & B[4][4]);
    C[2] ^= A[4][2];
    A[4][3] = B[4][3] ^ ((~B[4][4]) & B[4][0]);
    C[3] ^= A[4][3];
    A[4][4] = B[4][4] ^ ((~B[4][0]) & B[4][1]);
    C[4] ^= A[4][4];
    D[0] = C[4] ^ (((C[1]) << 1) ^ ((C[1]) >> (64 - 1)));
    D[1] = C[0] ^ (((C[2]) << 1) ^ ((C[2]) >> (64 - 1)));
    D[2] = C[1] ^ (((C[3]) << 1) ^ ((C[3]) >> (64 - 1)));
    D[3] = C[2] ^ (((C[4]) << 1) ^ ((C[4]) >> (64 - 1)));
    D[4] = C[3] ^ (((C[0]) << 1) ^ ((C[0]) >> (64 - 1)));
    A[0][0] ^= D[0];
    B[0][0] = A[0][0];
    A[1][1] ^= D[1];
    B[0][1] = (((A[1][1]) << 44) ^ ((A[1][1]) >> (64 - 44)));
    A[2][2] ^= D[2];
    B[0][2] = (((A[2][2]) << 43) ^ ((A[2][2]) >> (64 - 43)));
    A[3][3] ^= D[3];
    B[0][3] = (((A[3][3]) << 21) ^ ((A[3][3]) >> (64 - 21)));
    A[4][4] ^= D[4];
    B[0][4] = (((A[4][4]) << 14) ^ ((A[4][4]) >> (64 - 14)));
    E[0][0] = B[0][0] ^ ((~B[0][1]) & B[0][2]);
    E[0][0] ^= KECCAKF1600_ROUND_CONSTANTS[14];
    C[0] = E[0][0];
    E[0][1] = B[0][1] ^ ((~B[0][2]) & B[0][3]);
    C[1] = E[0][1];
    E[0][2] = B[0][2] ^ ((~B[0][3]) & B[0][4]);
    C[2] = E[0][2];
    E[0][3] = B[0][3] ^ ((~B[0][4]) & B[0][0]);
    C[3] = E[0][3];
    E[0][4] = B[0][4] ^ ((~B[0][0]) & B[0][1]);
    C[4] = E[0][4];
    A[0][3] ^= D[3];
    B[1][0] = (((A[0][3]) << 28) ^ ((A[0][3]) >> (64 - 28)));
    A[1][4] ^= D[4];
    B[1][1] = (((A[1][4]) << 20) ^ ((A[1][4]) >> (64 - 20)));
    A[2][0] ^= D[0];
    B[1][2] = (((A[2][0]) << 3) ^ ((A[2][0]) >> (64 - 3)));
    A[3][1] ^= D[1];
    B[1][3] = (((A[3][1]) << 45) ^ ((A[3][1]) >> (64 - 45)));
    A[4][2] ^= D[2];
    B[1][4] = (((A[4][2]) << 61) ^ ((A[4][2]) >> (64 - 61)));
    E[1][0] = B[1][0] ^ ((~B[1][1]) & B[1][2]);
    C[0] ^= E[1][0];
    E[1][1] = B[1][1] ^ ((~B[1][2]) & B[1][3]);
    C[1] ^= E[1][1];
    E[1][2] = B[1][2] ^ ((~B[1][3]) & B[1][4]);
    C[2] ^= E[1][2];
    E[1][3] = B[1][3] ^ ((~B[1][4]) & B[1][0]);
    C[3] ^= E[1][3];
    E[1][4] = B[1][4] ^ ((~B[1][0]) & B[1][1]);
    C[4] ^= E[1][4];
    A[0][1] ^= D[1];
    B[2][0] = (((A[0][1]) << 1) ^ ((A[0][1]) >> (64 - 1)));
    A[1][2] ^= D[2];
    B[2][1] = (((A[1][2]) << 6) ^ ((A[1][2]) >> (64 - 6)));
    A[2][3] ^= D[3];
    B[2][2] = (((A[2][3]) << 25) ^ ((A[2][3]) >> (64 - 25)));
    A[3][4] ^= D[4];
    B[2][3] = (((A[3][4]) << 8) ^ ((A[3][4]) >> (64 - 8)));
    A[4][0] ^= D[0];
    B[2][4] = (((A[4][0]) << 18) ^ ((A[4][0]) >> (64 - 18)));
    E[2][0] = B[2][0] ^ ((~B[2][1]) & B[2][2]);
    C[0] ^= E[2][0];
    E[2][1] = B[2][1] ^ ((~B[2][2]) & B[2][3]);
    C[1] ^= E[2][1];
    E[2][2] = B[2][2] ^ ((~B[2][3]) & B[2][4]);
    C[2] ^= E[2][2];
    E[2][3] = B[2][3] ^ ((~B[2][4]) & B[2][0]);
    C[3] ^= E[2][3];
    E[2][4] = B[2][4] ^ ((~B[2][0]) & B[2][1]);
    C[4] ^= E[2][4];
    A[0][4] ^= D[4];
    B[3][0] = (((A[0][4]) << 27) ^ ((A[0][4]) >> (64 - 27)));
    A[1][0] ^= D[0];
    B[3][1] = (((A[1][0]) << 36) ^ ((A[1][0]) >> (64 - 36)));
    A[2][1] ^= D[1];
    B[3][2] = (((A[2][1]) << 10) ^ ((A[2][1]) >> (64 - 10)));
    A[3][2] ^= D[2];
    B[3][3] = (((A[3][2]) << 15) ^ ((A[3][2]) >> (64 - 15)));
    A[4][3] ^= D[3];
    B[3][4] = (((A[4][3]) << 56) ^ ((A[4][3]) >> (64 - 56)));
    E[3][0] = B[3][0] ^ ((~B[3][1]) & B[3][2]);
    C[0] ^= E[3][0];
    E[3][1] = B[3][1] ^ ((~B[3][2]) & B[3][3]);
    C[1] ^= E[3][1];
    E[3][2] = B[3][2] ^ ((~B[3][3]) & B[3][4]);
    C[2] ^= E[3][2];
    E[3][3] = B[3][3] ^ ((~B[3][4]) & B[3][0]);
    C[3] ^= E[3][3];
    E[3][4] = B[3][4] ^ ((~B[3][0]) & B[3][1]);
    C[4] ^= E[3][4];
    A[0][2] ^= D[2];
    B[4][0] = (((A[0][2]) << 62) ^ ((A[0][2]) >> (64 - 62)));
    A[1][3] ^= D[3];
    B[4][1] = (((A[1][3]) << 55) ^ ((A[1][3]) >> (64 - 55)));
    A[2][4] ^= D[4];
    B[4][2] = (((A[2][4]) << 39) ^ ((A[2][4]) >> (64 - 39)));
    A[3][0] ^= D[0];
    B[4][3] = (((A[3][0]) << 41) ^ ((A[3][0]) >> (64 - 41)));
    A[4][1] ^= D[1];
    B[4][4] = (((A[4][1]) << 2) ^ ((A[4][1]) >> (64 - 2)));
    E[4][0] = B[4][0] ^ ((~B[4][1]) & B[4][2]);
    C[0] ^= E[4][0];
    E[4][1] = B[4][1] ^ ((~B[4][2]) & B[4][3]);
    C[1] ^= E[4][1];
    E[4][2] = B[4][2] ^ ((~B[4][3]) & B[4][4]);
    C[2] ^= E[4][2];
    E[4][3] = B[4][3] ^ ((~B[4][4]) & B[4][0]);
    C[3] ^= E[4][3];
    E[4][4] = B[4][4] ^ ((~B[4][0]) & B[4][1]);
    C[4] ^= E[4][4];
    D[0] = C[4] ^ (((C[1]) << 1) ^ ((C[1]) >> (64 - 1)));
    D[1] = C[0] ^ (((C[2]) << 1) ^ ((C[2]) >> (64 - 1)));
    D[2] = C[1] ^ (((C[3]) << 1) ^ ((C[3]) >> (64 - 1)));
    D[3] = C[2] ^ (((C[4]) << 1) ^ ((C[4]) >> (64 - 1)));
    D[4] = C[3] ^ (((C[0]) << 1) ^ ((C[0]) >> (64 - 1)));
    E[0][0] ^= D[0];
    B[0][0] = E[0][0];
    E[1][1] ^= D[1];
    B[0][1] = (((E[1][1]) << 44) ^ ((E[1][1]) >> (64 - 44)));
    E[2][2] ^= D[2];
    B[0][2] = (((E[2][2]) << 43) ^ ((E[2][2]) >> (64 - 43)));
    E[3][3] ^= D[3];
    B[0][3] = (((E[3][3]) << 21) ^ ((E[3][3]) >> (64 - 21)));
    E[4][4] ^= D[4];
    B[0][4] = (((E[4][4]) << 14) ^ ((E[4][4]) >> (64 - 14)));
    A[0][0] = B[0][0] ^ ((~B[0][1]) & B[0][2]);
    A[0][0] ^= KECCAKF1600_ROUND_CONSTANTS[15];
    C[0] = A[0][0];
    A[0][1] = B[0][1] ^ ((~B[0][2]) & B[0][3]);
    C[1] = A[0][1];
    A[0][2] = B[0][2] ^ ((~B[0][3]) & B[0][4]);
    C[2] = A[0][2];
    A[0][3] = B[0][3] ^ ((~B[0][4]) & B[0][0]);
    C[3] = A[0][3];
    A[0][4] = B[0][4] ^ ((~B[0][0]) & B[0][1]);
    C[4] = A[0][4];
    E[0][3] ^= D[3];
    B[1][0] = (((E[0][3]) << 28) ^ ((E[0][3]) >> (64 - 28)));
    E[1][4] ^= D[4];
    B[1][1] = (((E[1][4]) << 20) ^ ((E[1][4]) >> (64 - 20)));
    E[2][0] ^= D[0];
    B[1][2] = (((E[2][0]) << 3) ^ ((E[2][0]) >> (64 - 3)));
    E[3][1] ^= D[1];
    B[1][3] = (((E[3][1]) << 45) ^ ((E[3][1]) >> (64 - 45)));
    E[4][2] ^= D[2];
    B[1][4] = (((E[4][2]) << 61) ^ ((E[4][2]) >> (64 - 61)));
    A[1][0] = B[1][0] ^ ((~B[1][1]) & B[1][2]);
    C[0] ^= A[1][0];
    A[1][1] = B[1][1] ^ ((~B[1][2]) & B[1][3]);
    C[1] ^= A[1][1];
    A[1][2] = B[1][2] ^ ((~B[1][3]) & B[1][4]);
    C[2] ^= A[1][2];
    A[1][3] = B[1][3] ^ ((~B[1][4]) & B[1][0]);
    C[3] ^= A[1][3];
    A[1][4] = B[1][4] ^ ((~B[1][0]) & B[1][1]);
    C[4] ^= A[1][4];
    E[0][1] ^= D[1];
    B[2][0] = (((E[0][1]) << 1) ^ ((E[0][1]) >> (64 - 1)));
    E[1][2] ^= D[2];
    B[2][1] = (((E[1][2]) << 6) ^ ((E[1][2]) >> (64 - 6)));
    E[2][3] ^= D[3];
    B[2][2] = (((E[2][3]) << 25) ^ ((E[2][3]) >> (64 - 25)));
    E[3][4] ^= D[4];
    B[2][3] = (((E[3][4]) << 8) ^ ((E[3][4]) >> (64 - 8)));
    E[4][0] ^= D[0];
    B[2][4] = (((E[4][0]) << 18) ^ ((E[4][0]) >> (64 - 18)));
    A[2][0] = B[2][0] ^ ((~B[2][1]) & B[2][2]);
    C[0] ^= A[2][0];
    A[2][1] = B[2][1] ^ ((~B[2][2]) & B[2][3]);
    C[1] ^= A[2][1];
    A[2][2] = B[2][2] ^ ((~B[2][3]) & B[2][4]);
    C[2] ^= A[2][2];
    A[2][3] = B[2][3] ^ ((~B[2][4]) & B[2][0]);
    C[3] ^= A[2][3];
    A[2][4] = B[2][4] ^ ((~B[2][0]) & B[2][1]);
    C[4] ^= A[2][4];
    E[0][4] ^= D[4];
    B[3][0] = (((E[0][4]) << 27) ^ ((E[0][4]) >> (64 - 27)));
    E[1][0] ^= D[0];
    B[3][1] = (((E[1][0]) << 36) ^ ((E[1][0]) >> (64 - 36)));
    E[2][1] ^= D[1];
    B[3][2] = (((E[2][1]) << 10) ^ ((E[2][1]) >> (64 - 10)));
    E[3][2] ^= D[2];
    B[3][3] = (((E[3][2]) << 15) ^ ((E[3][2]) >> (64 - 15)));
    E[4][3] ^= D[3];
    B[3][4] = (((E[4][3]) << 56) ^ ((E[4][3]) >> (64 - 56)));
    A[3][0] = B[3][0] ^ ((~B[3][1]) & B[3][2]);
    C[0] ^= A[3][0];
    A[3][1] = B[3][1] ^ ((~B[3][2]) & B[3][3]);
    C[1] ^= A[3][1];
    A[3][2] = B[3][2] ^ ((~B[3][3]) & B[3][4]);
    C[2] ^= A[3][2];
    A[3][3] = B[3][3] ^ ((~B[3][4]) & B[3][0]);
    C[3] ^= A[3][3];
    A[3][4] = B[3][4] ^ ((~B[3][0]) & B[3][1]);
    C[4] ^= A[3][4];
    E[0][2] ^= D[2];
    B[4][0] = (((E[0][2]) << 62) ^ ((E[0][2]) >> (64 - 62)));
    E[1][3] ^= D[3];
    B[4][1] = (((E[1][3]) << 55) ^ ((E[1][3]) >> (64 - 55)));
    E[2][4] ^= D[4];
    B[4][2] = (((E[2][4]) << 39) ^ ((E[2][4]) >> (64 - 39)));
    E[3][0] ^= D[0];
    B[4][3] = (((E[3][0]) << 41) ^ ((E[3][0]) >> (64 - 41)));
    E[4][1] ^= D[1];
    B[4][4] = (((E[4][1]) << 2) ^ ((E[4][1]) >> (64 - 2)));
    A[4][0] = B[4][0] ^ ((~B[4][1]) & B[4][2]);
    C[0] ^= A[4][0];
    A[4][1] = B[4][1] ^ ((~B[4][2]) & B[4][3]);
    C[1] ^= A[4][1];
    A[4][2] = B[4][2] ^ ((~B[4][3]) & B[4][4]);
    C[2] ^= A[4][2];
    A[4][3] = B[4][3] ^ ((~B[4][4]) & B[4][0]);
    C[3] ^= A[4][3];
    A[4][4] = B[4][4] ^ ((~B[4][0]) & B[4][1]);
    C[4] ^= A[4][4];
    D[0] = C[4] ^ (((C[1]) << 1) ^ ((C[1]) >> (64 - 1)));
    D[1] = C[0] ^ (((C[2]) << 1) ^ ((C[2]) >> (64 - 1)));
    D[2] = C[1] ^ (((C[3]) << 1) ^ ((C[3]) >> (64 - 1)));
    D[3] = C[2] ^ (((C[4]) << 1) ^ ((C[4]) >> (64 - 1)));
    D[4] = C[3] ^ (((C[0]) << 1) ^ ((C[0]) >> (64 - 1)));
    A[0][0] ^= D[0];
    B[0][0] = A[0][0];
    A[1][1] ^= D[1];
    B[0][1] = (((A[1][1]) << 44) ^ ((A[1][1]) >> (64 - 44)));
    A[2][2] ^= D[2];
    B[0][2] = (((A[2][2]) << 43) ^ ((A[2][2]) >> (64 - 43)));
    A[3][3] ^= D[3];
    B[0][3] = (((A[3][3]) << 21) ^ ((A[3][3]) >> (64 - 21)));
    A[4][4] ^= D[4];
    B[0][4] = (((A[4][4]) << 14) ^ ((A[4][4]) >> (64 - 14)));
    E[0][0] = B[0][0] ^ ((~B[0][1]) & B[0][2]);
    E[0][0] ^= KECCAKF1600_ROUND_CONSTANTS[16];
    C[0] = E[0][0];
    E[0][1] = B[0][1] ^ ((~B[0][2]) & B[0][3]);
    C[1] = E[0][1];
    E[0][2] = B[0][2] ^ ((~B[0][3]) & B[0][4]);
    C[2] = E[0][2];
    E[0][3] = B[0][3] ^ ((~B[0][4]) & B[0][0]);
    C[3] = E[0][3];
    E[0][4] = B[0][4] ^ ((~B[0][0]) & B[0][1]);
    C[4] = E[0][4];
    A[0][3] ^= D[3];
    B[1][0] = (((A[0][3]) << 28) ^ ((A[0][3]) >> (64 - 28)));
    A[1][4] ^= D[4];
    B[1][1] = (((A[1][4]) << 20) ^ ((A[1][4]) >> (64 - 20)));
    A[2][0] ^= D[0];
    B[1][2] = (((A[2][0]) << 3) ^ ((A[2][0]) >> (64 - 3)));
    A[3][1] ^= D[1];
    B[1][3] = (((A[3][1]) << 45) ^ ((A[3][1]) >> (64 - 45)));
    A[4][2] ^= D[2];
    B[1][4] = (((A[4][2]) << 61) ^ ((A[4][2]) >> (64 - 61)));
    E[1][0] = B[1][0] ^ ((~B[1][1]) & B[1][2]);
    C[0] ^= E[1][0];
    E[1][1] = B[1][1] ^ ((~B[1][2]) & B[1][3]);
    C[1] ^= E[1][1];
    E[1][2] = B[1][2] ^ ((~B[1][3]) & B[1][4]);
    C[2] ^= E[1][2];
    E[1][3] = B[1][3] ^ ((~B[1][4]) & B[1][0]);
    C[3] ^= E[1][3];
    E[1][4] = B[1][4] ^ ((~B[1][0]) & B[1][1]);
    C[4] ^= E[1][4];
    A[0][1] ^= D[1];
    B[2][0] = (((A[0][1]) << 1) ^ ((A[0][1]) >> (64 - 1)));
    A[1][2] ^= D[2];
    B[2][1] = (((A[1][2]) << 6) ^ ((A[1][2]) >> (64 - 6)));
    A[2][3] ^= D[3];
    B[2][2] = (((A[2][3]) << 25) ^ ((A[2][3]) >> (64 - 25)));
    A[3][4] ^= D[4];
    B[2][3] = (((A[3][4]) << 8) ^ ((A[3][4]) >> (64 - 8)));
    A[4][0] ^= D[0];
    B[2][4] = (((A[4][0]) << 18) ^ ((A[4][0]) >> (64 - 18)));
    E[2][0] = B[2][0] ^ ((~B[2][1]) & B[2][2]);
    C[0] ^= E[2][0];
    E[2][1] = B[2][1] ^ ((~B[2][2]) & B[2][3]);
    C[1] ^= E[2][1];
    E[2][2] = B[2][2] ^ ((~B[2][3]) & B[2][4]);
    C[2] ^= E[2][2];
    E[2][3] = B[2][3] ^ ((~B[2][4]) & B[2][0]);
    C[3] ^= E[2][3];
    E[2][4] = B[2][4] ^ ((~B[2][0]) & B[2][1]);
    C[4] ^= E[2][4];
    A[0][4] ^= D[4];
    B[3][0] = (((A[0][4]) << 27) ^ ((A[0][4]) >> (64 - 27)));
    A[1][0] ^= D[0];
    B[3][1] = (((A[1][0]) << 36) ^ ((A[1][0]) >> (64 - 36)));
    A[2][1] ^= D[1];
    B[3][2] = (((A[2][1]) << 10) ^ ((A[2][1]) >> (64 - 10)));
    A[3][2] ^= D[2];
    B[3][3] = (((A[3][2]) << 15) ^ ((A[3][2]) >> (64 - 15)));
    A[4][3] ^= D[3];
    B[3][4] = (((A[4][3]) << 56) ^ ((A[4][3]) >> (64 - 56)));
    E[3][0] = B[3][0] ^ ((~B[3][1]) & B[3][2]);
    C[0] ^= E[3][0];
    E[3][1] = B[3][1] ^ ((~B[3][2]) & B[3][3]);
    C[1] ^= E[3][1];
    E[3][2] = B[3][2] ^ ((~B[3][3]) & B[3][4]);
    C[2] ^= E[3][2];
    E[3][3] = B[3][3] ^ ((~B[3][4]) & B[3][0]);
    C[3] ^= E[3][3];
    E[3][4] = B[3][4] ^ ((~B[3][0]) & B[3][1]);
    C[4] ^= E[3][4];
    A[0][2] ^= D[2];
    B[4][0] = (((A[0][2]) << 62) ^ ((A[0][2]) >> (64 - 62)));
    A[1][3] ^= D[3];
    B[4][1] = (((A[1][3]) << 55) ^ ((A[1][3]) >> (64 - 55)));
    A[2][4] ^= D[4];
    B[4][2] = (((A[2][4]) << 39) ^ ((A[2][4]) >> (64 - 39)));
    A[3][0] ^= D[0];
    B[4][3] = (((A[3][0]) << 41) ^ ((A[3][0]) >> (64 - 41)));
    A[4][1] ^= D[1];
    B[4][4] = (((A[4][1]) << 2) ^ ((A[4][1]) >> (64 - 2)));
    E[4][0] = B[4][0] ^ ((~B[4][1]) & B[4][2]);
    C[0] ^= E[4][0];
    E[4][1] = B[4][1] ^ ((~B[4][2]) & B[4][3]);
    C[1] ^= E[4][1];
    E[4][2] = B[4][2] ^ ((~B[4][3]) & B[4][4]);
    C[2] ^= E[4][2];
    E[4][3] = B[4][3] ^ ((~B[4][4]) & B[4][0]);
    C[3] ^= E[4][3];
    E[4][4] = B[4][4] ^ ((~B[4][0]) & B[4][1]);
    C[4] ^= E[4][4];
    D[0] = C[4] ^ (((C[1]) << 1) ^ ((C[1]) >> (64 - 1)));
    D[1] = C[0] ^ (((C[2]) << 1) ^ ((C[2]) >> (64 - 1)));
    D[2] = C[1] ^ (((C[3]) << 1) ^ ((C[3]) >> (64 - 1)));
    D[3] = C[2] ^ (((C[4]) << 1) ^ ((C[4]) >> (64 - 1)));
    D[4] = C[3] ^ (((C[0]) << 1) ^ ((C[0]) >> (64 - 1)));
    E[0][0] ^= D[0];
    B[0][0] = E[0][0];
    E[1][1] ^= D[1];
    B[0][1] = (((E[1][1]) << 44) ^ ((E[1][1]) >> (64 - 44)));
    E[2][2] ^= D[2];
    B[0][2] = (((E[2][2]) << 43) ^ ((E[2][2]) >> (64 - 43)));
    E[3][3] ^= D[3];
    B[0][3] = (((E[3][3]) << 21) ^ ((E[3][3]) >> (64 - 21)));
    E[4][4] ^= D[4];
    B[0][4] = (((E[4][4]) << 14) ^ ((E[4][4]) >> (64 - 14)));
    A[0][0] = B[0][0] ^ ((~B[0][1]) & B[0][2]);
    A[0][0] ^= KECCAKF1600_ROUND_CONSTANTS[17];
    C[0] = A[0][0];
    A[0][1] = B[0][1] ^ ((~B[0][2]) & B[0][3]);
    C[1] = A[0][1];
    A[0][2] = B[0][2] ^ ((~B[0][3]) & B[0][4]);
    C[2] = A[0][2];
    A[0][3] = B[0][3] ^ ((~B[0][4]) & B[0][0]);
    C[3] = A[0][3];
    A[0][4] = B[0][4] ^ ((~B[0][0]) & B[0][1]);
    C[4] = A[0][4];
    E[0][3] ^= D[3];
    B[1][0] = (((E[0][3]) << 28) ^ ((E[0][3]) >> (64 - 28)));
    E[1][4] ^= D[4];
    B[1][1] = (((E[1][4]) << 20) ^ ((E[1][4]) >> (64 - 20)));
    E[2][0] ^= D[0];
    B[1][2] = (((E[2][0]) << 3) ^ ((E[2][0]) >> (64 - 3)));
    E[3][1] ^= D[1];
    B[1][3] = (((E[3][1]) << 45) ^ ((E[3][1]) >> (64 - 45)));
    E[4][2] ^= D[2];
    B[1][4] = (((E[4][2]) << 61) ^ ((E[4][2]) >> (64 - 61)));
    A[1][0] = B[1][0] ^ ((~B[1][1]) & B[1][2]);
    C[0] ^= A[1][0];
    A[1][1] = B[1][1] ^ ((~B[1][2]) & B[1][3]);
    C[1] ^= A[1][1];
    A[1][2] = B[1][2] ^ ((~B[1][3]) & B[1][4]);
    C[2] ^= A[1][2];
    A[1][3] = B[1][3] ^ ((~B[1][4]) & B[1][0]);
    C[3] ^= A[1][3];
    A[1][4] = B[1][4] ^ ((~B[1][0]) & B[1][1]);
    C[4] ^= A[1][4];
    E[0][1] ^= D[1];
    B[2][0] = (((E[0][1]) << 1) ^ ((E[0][1]) >> (64 - 1)));
    E[1][2] ^= D[2];
    B[2][1] = (((E[1][2]) << 6) ^ ((E[1][2]) >> (64 - 6)));
    E[2][3] ^= D[3];
    B[2][2] = (((E[2][3]) << 25) ^ ((E[2][3]) >> (64 - 25)));
    E[3][4] ^= D[4];
    B[2][3] = (((E[3][4]) << 8) ^ ((E[3][4]) >> (64 - 8)));
    E[4][0] ^= D[0];
    B[2][4] = (((E[4][0]) << 18) ^ ((E[4][0]) >> (64 - 18)));
    A[2][0] = B[2][0] ^ ((~B[2][1]) & B[2][2]);
    C[0] ^= A[2][0];
    A[2][1] = B[2][1] ^ ((~B[2][2]) & B[2][3]);
    C[1] ^= A[2][1];
    A[2][2] = B[2][2] ^ ((~B[2][3]) & B[2][4]);
    C[2] ^= A[2][2];
    A[2][3] = B[2][3] ^ ((~B[2][4]) & B[2][0]);
    C[3] ^= A[2][3];
    A[2][4] = B[2][4] ^ ((~B[2][0]) & B[2][1]);
    C[4] ^= A[2][4];
    E[0][4] ^= D[4];
    B[3][0] = (((E[0][4]) << 27) ^ ((E[0][4]) >> (64 - 27)));
    E[1][0] ^= D[0];
    B[3][1] = (((E[1][0]) << 36) ^ ((E[1][0]) >> (64 - 36)));
    E[2][1] ^= D[1];
    B[3][2] = (((E[2][1]) << 10) ^ ((E[2][1]) >> (64 - 10)));
    E[3][2] ^= D[2];
    B[3][3] = (((E[3][2]) << 15) ^ ((E[3][2]) >> (64 - 15)));
    E[4][3] ^= D[3];
    B[3][4] = (((E[4][3]) << 56) ^ ((E[4][3]) >> (64 - 56)));
    A[3][0] = B[3][0] ^ ((~B[3][1]) & B[3][2]);
    C[0] ^= A[3][0];
    A[3][1] = B[3][1] ^ ((~B[3][2]) & B[3][3]);
    C[1] ^= A[3][1];
    A[3][2] = B[3][2] ^ ((~B[3][3]) & B[3][4]);
    C[2] ^= A[3][2];
    A[3][3] = B[3][3] ^ ((~B[3][4]) & B[3][0]);
    C[3] ^= A[3][3];
    A[3][4] = B[3][4] ^ ((~B[3][0]) & B[3][1]);
    C[4] ^= A[3][4];
    E[0][2] ^= D[2];
    B[4][0] = (((E[0][2]) << 62) ^ ((E[0][2]) >> (64 - 62)));
    E[1][3] ^= D[3];
    B[4][1] = (((E[1][3]) << 55) ^ ((E[1][3]) >> (64 - 55)));
    E[2][4] ^= D[4];
    B[4][2] = (((E[2][4]) << 39) ^ ((E[2][4]) >> (64 - 39)));
    E[3][0] ^= D[0];
    B[4][3] = (((E[3][0]) << 41) ^ ((E[3][0]) >> (64 - 41)));
    E[4][1] ^= D[1];
    B[4][4] = (((E[4][1]) << 2) ^ ((E[4][1]) >> (64 - 2)));
    A[4][0] = B[4][0] ^ ((~B[4][1]) & B[4][2]);
    C[0] ^= A[4][0];
    A[4][1] = B[4][1] ^ ((~B[4][2]) & B[4][3]);
    C[1] ^= A[4][1];
    A[4][2] = B[4][2] ^ ((~B[4][3]) & B[4][4]);
    C[2] ^= A[4][2];
    A[4][3] = B[4][3] ^ ((~B[4][4]) & B[4][0]);
    C[3] ^= A[4][3];
    A[4][4] = B[4][4] ^ ((~B[4][0]) & B[4][1]);
    C[4] ^= A[4][4];
    D[0] = C[4] ^ (((C[1]) << 1) ^ ((C[1]) >> (64 - 1)));
    D[1] = C[0] ^ (((C[2]) << 1) ^ ((C[2]) >> (64 - 1)));
    D[2] = C[1] ^ (((C[3]) << 1) ^ ((C[3]) >> (64 - 1)));
    D[3] = C[2] ^ (((C[4]) << 1) ^ ((C[4]) >> (64 - 1)));
    D[4] = C[3] ^ (((C[0]) << 1) ^ ((C[0]) >> (64 - 1)));
    A[0][0] ^= D[0];
    B[0][0] = A[0][0];
    A[1][1] ^= D[1];
    B[0][1] = (((A[1][1]) << 44) ^ ((A[1][1]) >> (64 - 44)));
    A[2][2] ^= D[2];
    B[0][2] = (((A[2][2]) << 43) ^ ((A[2][2]) >> (64 - 43)));
    A[3][3] ^= D[3];
    B[0][3] = (((A[3][3]) << 21) ^ ((A[3][3]) >> (64 - 21)));
    A[4][4] ^= D[4];
    B[0][4] = (((A[4][4]) << 14) ^ ((A[4][4]) >> (64 - 14)));
    E[0][0] = B[0][0] ^ ((~B[0][1]) & B[0][2]);
    E[0][0] ^= KECCAKF1600_ROUND_CONSTANTS[18];
    C[0] = E[0][0];
    E[0][1] = B[0][1] ^ ((~B[0][2]) & B[0][3]);
    C[1] = E[0][1];
    E[0][2] = B[0][2] ^ ((~B[0][3]) & B[0][4]);
    C[2] = E[0][2];
    E[0][3] = B[0][3] ^ ((~B[0][4]) & B[0][0]);
    C[3] = E[0][3];
    E[0][4] = B[0][4] ^ ((~B[0][0]) & B[0][1]);
    C[4] = E[0][4];
    A[0][3] ^= D[3];
    B[1][0] = (((A[0][3]) << 28) ^ ((A[0][3]) >> (64 - 28)));
    A[1][4] ^= D[4];
    B[1][1] = (((A[1][4]) << 20) ^ ((A[1][4]) >> (64 - 20)));
    A[2][0] ^= D[0];
    B[1][2] = (((A[2][0]) << 3) ^ ((A[2][0]) >> (64 - 3)));
    A[3][1] ^= D[1];
    B[1][3] = (((A[3][1]) << 45) ^ ((A[3][1]) >> (64 - 45)));
    A[4][2] ^= D[2];
    B[1][4] = (((A[4][2]) << 61) ^ ((A[4][2]) >> (64 - 61)));
    E[1][0] = B[1][0] ^ ((~B[1][1]) & B[1][2]);
    C[0] ^= E[1][0];
    E[1][1] = B[1][1] ^ ((~B[1][2]) & B[1][3]);
    C[1] ^= E[1][1];
    E[1][2] = B[1][2] ^ ((~B[1][3]) & B[1][4]);
    C[2] ^= E[1][2];
    E[1][3] = B[1][3] ^ ((~B[1][4]) & B[1][0]);
    C[3] ^= E[1][3];
    E[1][4] = B[1][4] ^ ((~B[1][0]) & B[1][1]);
    C[4] ^= E[1][4];
    A[0][1] ^= D[1];
    B[2][0] = (((A[0][1]) << 1) ^ ((A[0][1]) >> (64 - 1)));
    A[1][2] ^= D[2];
    B[2][1] = (((A[1][2]) << 6) ^ ((A[1][2]) >> (64 - 6)));
    A[2][3] ^= D[3];
    B[2][2] = (((A[2][3]) << 25) ^ ((A[2][3]) >> (64 - 25)));
    A[3][4] ^= D[4];
    B[2][3] = (((A[3][4]) << 8) ^ ((A[3][4]) >> (64 - 8)));
    A[4][0] ^= D[0];
    B[2][4] = (((A[4][0]) << 18) ^ ((A[4][0]) >> (64 - 18)));
    E[2][0] = B[2][0] ^ ((~B[2][1]) & B[2][2]);
    C[0] ^= E[2][0];
    E[2][1] = B[2][1] ^ ((~B[2][2]) & B[2][3]);
    C[1] ^= E[2][1];
    E[2][2] = B[2][2] ^ ((~B[2][3]) & B[2][4]);
    C[2] ^= E[2][2];
    E[2][3] = B[2][3] ^ ((~B[2][4]) & B[2][0]);
    C[3] ^= E[2][3];
    E[2][4] = B[2][4] ^ ((~B[2][0]) & B[2][1]);
    C[4] ^= E[2][4];
    A[0][4] ^= D[4];
    B[3][0] = (((A[0][4]) << 27) ^ ((A[0][4]) >> (64 - 27)));
    A[1][0] ^= D[0];
    B[3][1] = (((A[1][0]) << 36) ^ ((A[1][0]) >> (64 - 36)));
    A[2][1] ^= D[1];
    B[3][2] = (((A[2][1]) << 10) ^ ((A[2][1]) >> (64 - 10)));
    A[3][2] ^= D[2];
    B[3][3] = (((A[3][2]) << 15) ^ ((A[3][2]) >> (64 - 15)));
    A[4][3] ^= D[3];
    B[3][4] = (((A[4][3]) << 56) ^ ((A[4][3]) >> (64 - 56)));
    E[3][0] = B[3][0] ^ ((~B[3][1]) & B[3][2]);
    C[0] ^= E[3][0];
    E[3][1] = B[3][1] ^ ((~B[3][2]) & B[3][3]);
    C[1] ^= E[3][1];
    E[3][2] = B[3][2] ^ ((~B[3][3]) & B[3][4]);
    C[2] ^= E[3][2];
    E[3][3] = B[3][3] ^ ((~B[3][4]) & B[3][0]);
    C[3] ^= E[3][3];
    E[3][4] = B[3][4] ^ ((~B[3][0]) & B[3][1]);
    C[4] ^= E[3][4];
    A[0][2] ^= D[2];
    B[4][0] = (((A[0][2]) << 62) ^ ((A[0][2]) >> (64 - 62)));
    A[1][3] ^= D[3];
    B[4][1] = (((A[1][3]) << 55) ^ ((A[1][3]) >> (64 - 55)));
    A[2][4] ^= D[4];
    B[4][2] = (((A[2][4]) << 39) ^ ((A[2][4]) >> (64 - 39)));
    A[3][0] ^= D[0];
    B[4][3] = (((A[3][0]) << 41) ^ ((A[3][0]) >> (64 - 41)));
    A[4][1] ^= D[1];
    B[4][4] = (((A[4][1]) << 2) ^ ((A[4][1]) >> (64 - 2)));
    E[4][0] = B[4][0] ^ ((~B[4][1]) & B[4][2]);
    C[0] ^= E[4][0];
    E[4][1] = B[4][1] ^ ((~B[4][2]) & B[4][3]);
    C[1] ^= E[4][1];
    E[4][2] = B[4][2] ^ ((~B[4][3]) & B[4][4]);
    C[2] ^= E[4][2];
    E[4][3] = B[4][3] ^ ((~B[4][4]) & B[4][0]);
    C[3] ^= E[4][3];
    E[4][4] = B[4][4] ^ ((~B[4][0]) & B[4][1]);
    C[4] ^= E[4][4];
    D[0] = C[4] ^ (((C[1]) << 1) ^ ((C[1]) >> (64 - 1)));
    D[1] = C[0] ^ (((C[2]) << 1) ^ ((C[2]) >> (64 - 1)));
    D[2] = C[1] ^ (((C[3]) << 1) ^ ((C[3]) >> (64 - 1)));
    D[3] = C[2] ^ (((C[4]) << 1) ^ ((C[4]) >> (64 - 1)));
    D[4] = C[3] ^ (((C[0]) << 1) ^ ((C[0]) >> (64 - 1)));
    E[0][0] ^= D[0];
    B[0][0] = E[0][0];
    E[1][1] ^= D[1];
    B[0][1] = (((E[1][1]) << 44) ^ ((E[1][1]) >> (64 - 44)));
    E[2][2] ^= D[2];
    B[0][2] = (((E[2][2]) << 43) ^ ((E[2][2]) >> (64 - 43)));
    E[3][3] ^= D[3];
    B[0][3] = (((E[3][3]) << 21) ^ ((E[3][3]) >> (64 - 21)));
    E[4][4] ^= D[4];
    B[0][4] = (((E[4][4]) << 14) ^ ((E[4][4]) >> (64 - 14)));
    A[0][0] = B[0][0] ^ ((~B[0][1]) & B[0][2]);
    A[0][0] ^= KECCAKF1600_ROUND_CONSTANTS[19];
    C[0] = A[0][0];
    A[0][1] = B[0][1] ^ ((~B[0][2]) & B[0][3]);
    C[1] = A[0][1];
    A[0][2] = B[0][2] ^ ((~B[0][3]) & B[0][4]);
    C[2] = A[0][2];
    A[0][3] = B[0][3] ^ ((~B[0][4]) & B[0][0]);
    C[3] = A[0][3];
    A[0][4] = B[0][4] ^ ((~B[0][0]) & B[0][1]);
    C[4] = A[0][4];
    E[0][3] ^= D[3];
    B[1][0] = (((E[0][3]) << 28) ^ ((E[0][3]) >> (64 - 28)));
    E[1][4] ^= D[4];
    B[1][1] = (((E[1][4]) << 20) ^ ((E[1][4]) >> (64 - 20)));
    E[2][0] ^= D[0];
    B[1][2] = (((E[2][0]) << 3) ^ ((E[2][0]) >> (64 - 3)));
    E[3][1] ^= D[1];
    B[1][3] = (((E[3][1]) << 45) ^ ((E[3][1]) >> (64 - 45)));
    E[4][2] ^= D[2];
    B[1][4] = (((E[4][2]) << 61) ^ ((E[4][2]) >> (64 - 61)));
    A[1][0] = B[1][0] ^ ((~B[1][1]) & B[1][2]);
    C[0] ^= A[1][0];
    A[1][1] = B[1][1] ^ ((~B[1][2]) & B[1][3]);
    C[1] ^= A[1][1];
    A[1][2] = B[1][2] ^ ((~B[1][3]) & B[1][4]);
    C[2] ^= A[1][2];
    A[1][3] = B[1][3] ^ ((~B[1][4]) & B[1][0]);
    C[3] ^= A[1][3];
    A[1][4] = B[1][4] ^ ((~B[1][0]) & B[1][1]);
    C[4] ^= A[1][4];
    E[0][1] ^= D[1];
    B[2][0] = (((E[0][1]) << 1) ^ ((E[0][1]) >> (64 - 1)));
    E[1][2] ^= D[2];
    B[2][1] = (((E[1][2]) << 6) ^ ((E[1][2]) >> (64 - 6)));
    E[2][3] ^= D[3];
    B[2][2] = (((E[2][3]) << 25) ^ ((E[2][3]) >> (64 - 25)));
    E[3][4] ^= D[4];
    B[2][3] = (((E[3][4]) << 8) ^ ((E[3][4]) >> (64 - 8)));
    E[4][0] ^= D[0];
    B[2][4] = (((E[4][0]) << 18) ^ ((E[4][0]) >> (64 - 18)));
    A[2][0] = B[2][0] ^ ((~B[2][1]) & B[2][2]);
    C[0] ^= A[2][0];
    A[2][1] = B[2][1] ^ ((~B[2][2]) & B[2][3]);
    C[1] ^= A[2][1];
    A[2][2] = B[2][2] ^ ((~B[2][3]) & B[2][4]);
    C[2] ^= A[2][2];
    A[2][3] = B[2][3] ^ ((~B[2][4]) & B[2][0]);
    C[3] ^= A[2][3];
    A[2][4] = B[2][4] ^ ((~B[2][0]) & B[2][1]);
    C[4] ^= A[2][4];
    E[0][4] ^= D[4];
    B[3][0] = (((E[0][4]) << 27) ^ ((E[0][4]) >> (64 - 27)));
    E[1][0] ^= D[0];
    B[3][1] = (((E[1][0]) << 36) ^ ((E[1][0]) >> (64 - 36)));
    E[2][1] ^= D[1];
    B[3][2] = (((E[2][1]) << 10) ^ ((E[2][1]) >> (64 - 10)));
    E[3][2] ^= D[2];
    B[3][3] = (((E[3][2]) << 15) ^ ((E[3][2]) >> (64 - 15)));
    E[4][3] ^= D[3];
    B[3][4] = (((E[4][3]) << 56) ^ ((E[4][3]) >> (64 - 56)));
    A[3][0] = B[3][0] ^ ((~B[3][1]) & B[3][2]);
    C[0] ^= A[3][0];
    A[3][1] = B[3][1] ^ ((~B[3][2]) & B[3][3]);
    C[1] ^= A[3][1];
    A[3][2] = B[3][2] ^ ((~B[3][3]) & B[3][4]);
    C[2] ^= A[3][2];
    A[3][3] = B[3][3] ^ ((~B[3][4]) & B[3][0]);
    C[3] ^= A[3][3];
    A[3][4] = B[3][4] ^ ((~B[3][0]) & B[3][1]);
    C[4] ^= A[3][4];
    E[0][2] ^= D[2];
    B[4][0] = (((E[0][2]) << 62) ^ ((E[0][2]) >> (64 - 62)));
    E[1][3] ^= D[3];
    B[4][1] = (((E[1][3]) << 55) ^ ((E[1][3]) >> (64 - 55)));
    E[2][4] ^= D[4];
    B[4][2] = (((E[2][4]) << 39) ^ ((E[2][4]) >> (64 - 39)));
    E[3][0] ^= D[0];
    B[4][3] = (((E[3][0]) << 41) ^ ((E[3][0]) >> (64 - 41)));
    E[4][1] ^= D[1];
    B[4][4] = (((E[4][1]) << 2) ^ ((E[4][1]) >> (64 - 2)));
    A[4][0] = B[4][0] ^ ((~B[4][1]) & B[4][2]);
    C[0] ^= A[4][0];
    A[4][1] = B[4][1] ^ ((~B[4][2]) & B[4][3]);
    C[1] ^= A[4][1];
    A[4][2] = B[4][2] ^ ((~B[4][3]) & B[4][4]);
    C[2] ^= A[4][2];
    A[4][3] = B[4][3] ^ ((~B[4][4]) & B[4][0]);
    C[3] ^= A[4][3];
    A[4][4] = B[4][4] ^ ((~B[4][0]) & B[4][1]);
    C[4] ^= A[4][4];
    D[0] = C[4] ^ (((C[1]) << 1) ^ ((C[1]) >> (64 - 1)));
    D[1] = C[0] ^ (((C[2]) << 1) ^ ((C[2]) >> (64 - 1)));
    D[2] = C[1] ^ (((C[3]) << 1) ^ ((C[3]) >> (64 - 1)));
    D[3] = C[2] ^ (((C[4]) << 1) ^ ((C[4]) >> (64 - 1)));
    D[4] = C[3] ^ (((C[0]) << 1) ^ ((C[0]) >> (64 - 1)));
    A[0][0] ^= D[0];
    B[0][0] = A[0][0];
    A[1][1] ^= D[1];
    B[0][1] = (((A[1][1]) << 44) ^ ((A[1][1]) >> (64 - 44)));
    A[2][2] ^= D[2];
    B[0][2] = (((A[2][2]) << 43) ^ ((A[2][2]) >> (64 - 43)));
    A[3][3] ^= D[3];
    B[0][3] = (((A[3][3]) << 21) ^ ((A[3][3]) >> (64 - 21)));
    A[4][4] ^= D[4];
    B[0][4] = (((A[4][4]) << 14) ^ ((A[4][4]) >> (64 - 14)));
    E[0][0] = B[0][0] ^ ((~B[0][1]) & B[0][2]);
    E[0][0] ^= KECCAKF1600_ROUND_CONSTANTS[20];
    C[0] = E[0][0];
    E[0][1] = B[0][1] ^ ((~B[0][2]) & B[0][3]);
    C[1] = E[0][1];
    E[0][2] = B[0][2] ^ ((~B[0][3]) & B[0][4]);
    C[2] = E[0][2];
    E[0][3] = B[0][3] ^ ((~B[0][4]) & B[0][0]);
    C[3] = E[0][3];
    E[0][4] = B[0][4] ^ ((~B[0][0]) & B[0][1]);
    C[4] = E[0][4];
    A[0][3] ^= D[3];
    B[1][0] = (((A[0][3]) << 28) ^ ((A[0][3]) >> (64 - 28)));
    A[1][4] ^= D[4];
    B[1][1] = (((A[1][4]) << 20) ^ ((A[1][4]) >> (64 - 20)));
    A[2][0] ^= D[0];
    B[1][2] = (((A[2][0]) << 3) ^ ((A[2][0]) >> (64 - 3)));
    A[3][1] ^= D[1];
    B[1][3] = (((A[3][1]) << 45) ^ ((A[3][1]) >> (64 - 45)));
    A[4][2] ^= D[2];
    B[1][4] = (((A[4][2]) << 61) ^ ((A[4][2]) >> (64 - 61)));
    E[1][0] = B[1][0] ^ ((~B[1][1]) & B[1][2]);
    C[0] ^= E[1][0];
    E[1][1] = B[1][1] ^ ((~B[1][2]) & B[1][3]);
    C[1] ^= E[1][1];
    E[1][2] = B[1][2] ^ ((~B[1][3]) & B[1][4]);
    C[2] ^= E[1][2];
    E[1][3] = B[1][3] ^ ((~B[1][4]) & B[1][0]);
    C[3] ^= E[1][3];
    E[1][4] = B[1][4] ^ ((~B[1][0]) & B[1][1]);
    C[4] ^= E[1][4];
    A[0][1] ^= D[1];
    B[2][0] = (((A[0][1]) << 1) ^ ((A[0][1]) >> (64 - 1)));
    A[1][2] ^= D[2];
    B[2][1] = (((A[1][2]) << 6) ^ ((A[1][2]) >> (64 - 6)));
    A[2][3] ^= D[3];
    B[2][2] = (((A[2][3]) << 25) ^ ((A[2][3]) >> (64 - 25)));
    A[3][4] ^= D[4];
    B[2][3] = (((A[3][4]) << 8) ^ ((A[3][4]) >> (64 - 8)));
    A[4][0] ^= D[0];
    B[2][4] = (((A[4][0]) << 18) ^ ((A[4][0]) >> (64 - 18)));
    E[2][0] = B[2][0] ^ ((~B[2][1]) & B[2][2]);
    C[0] ^= E[2][0];
    E[2][1] = B[2][1] ^ ((~B[2][2]) & B[2][3]);
    C[1] ^= E[2][1];
    E[2][2] = B[2][2] ^ ((~B[2][3]) & B[2][4]);
    C[2] ^= E[2][2];
    E[2][3] = B[2][3] ^ ((~B[2][4]) & B[2][0]);
    C[3] ^= E[2][3];
    E[2][4] = B[2][4] ^ ((~B[2][0]) & B[2][1]);
    C[4] ^= E[2][4];
    A[0][4] ^= D[4];
    B[3][0] = (((A[0][4]) << 27) ^ ((A[0][4]) >> (64 - 27)));
    A[1][0] ^= D[0];
    B[3][1] = (((A[1][0]) << 36) ^ ((A[1][0]) >> (64 - 36)));
    A[2][1] ^= D[1];
    B[3][2] = (((A[2][1]) << 10) ^ ((A[2][1]) >> (64 - 10)));
    A[3][2] ^= D[2];
    B[3][3] = (((A[3][2]) << 15) ^ ((A[3][2]) >> (64 - 15)));
    A[4][3] ^= D[3];
    B[3][4] = (((A[4][3]) << 56) ^ ((A[4][3]) >> (64 - 56)));
    E[3][0] = B[3][0] ^ ((~B[3][1]) & B[3][2]);
    C[0] ^= E[3][0];
    E[3][1] = B[3][1] ^ ((~B[3][2]) & B[3][3]);
    C[1] ^= E[3][1];
    E[3][2] = B[3][2] ^ ((~B[3][3]) & B[3][4]);
    C[2] ^= E[3][2];
    E[3][3] = B[3][3] ^ ((~B[3][4]) & B[3][0]);
    C[3] ^= E[3][3];
    E[3][4] = B[3][4] ^ ((~B[3][0]) & B[3][1]);
    C[4] ^= E[3][4];
    A[0][2] ^= D[2];
    B[4][0] = (((A[0][2]) << 62) ^ ((A[0][2]) >> (64 - 62)));
    A[1][3] ^= D[3];
    B[4][1] = (((A[1][3]) << 55) ^ ((A[1][3]) >> (64 - 55)));
    A[2][4] ^= D[4];
    B[4][2] = (((A[2][4]) << 39) ^ ((A[2][4]) >> (64 - 39)));
    A[3][0] ^= D[0];
    B[4][3] = (((A[3][0]) << 41) ^ ((A[3][0]) >> (64 - 41)));
    A[4][1] ^= D[1];
    B[4][4] = (((A[4][1]) << 2) ^ ((A[4][1]) >> (64 - 2)));
    E[4][0] = B[4][0] ^ ((~B[4][1]) & B[4][2]);
    C[0] ^= E[4][0];
    E[4][1] = B[4][1] ^ ((~B[4][2]) & B[4][3]);
    C[1] ^= E[4][1];
    E[4][2] = B[4][2] ^ ((~B[4][3]) & B[4][4]);
    C[2] ^= E[4][2];
    E[4][3] = B[4][3] ^ ((~B[4][4]) & B[4][0]);
    C[3] ^= E[4][3];
    E[4][4] = B[4][4] ^ ((~B[4][0]) & B[4][1]);
    C[4] ^= E[4][4];
    D[0] = C[4] ^ (((C[1]) << 1) ^ ((C[1]) >> (64 - 1)));
    D[1] = C[0] ^ (((C[2]) << 1) ^ ((C[2]) >> (64 - 1)));
    D[2] = C[1] ^ (((C[3]) << 1) ^ ((C[3]) >> (64 - 1)));
    D[3] = C[2] ^ (((C[4]) << 1) ^ ((C[4]) >> (64 - 1)));
    D[4] = C[3] ^ (((C[0]) << 1) ^ ((C[0]) >> (64 - 1)));
    E[0][0] ^= D[0];
    B[0][0] = E[0][0];
    E[1][1] ^= D[1];
    B[0][1] = (((E[1][1]) << 44) ^ ((E[1][1]) >> (64 - 44)));
    E[2][2] ^= D[2];
    B[0][2] = (((E[2][2]) << 43) ^ ((E[2][2]) >> (64 - 43)));
    E[3][3] ^= D[3];
    B[0][3] = (((E[3][3]) << 21) ^ ((E[3][3]) >> (64 - 21)));
    E[4][4] ^= D[4];
    B[0][4] = (((E[4][4]) << 14) ^ ((E[4][4]) >> (64 - 14)));
    A[0][0] = B[0][0] ^ ((~B[0][1]) & B[0][2]);
    A[0][0] ^= KECCAKF1600_ROUND_CONSTANTS[21];
    C[0] = A[0][0];
    A[0][1] = B[0][1] ^ ((~B[0][2]) & B[0][3]);
    C[1] = A[0][1];
    A[0][2] = B[0][2] ^ ((~B[0][3]) & B[0][4]);
    C[2] = A[0][2];
    A[0][3] = B[0][3] ^ ((~B[0][4]) & B[0][0]);
    C[3] = A[0][3];
    A[0][4] = B[0][4] ^ ((~B[0][0]) & B[0][1]);
    C[4] = A[0][4];
    E[0][3] ^= D[3];
    B[1][0] = (((E[0][3]) << 28) ^ ((E[0][3]) >> (64 - 28)));
    E[1][4] ^= D[4];
    B[1][1] = (((E[1][4]) << 20) ^ ((E[1][4]) >> (64 - 20)));
    E[2][0] ^= D[0];
    B[1][2] = (((E[2][0]) << 3) ^ ((E[2][0]) >> (64 - 3)));
    E[3][1] ^= D[1];
    B[1][3] = (((E[3][1]) << 45) ^ ((E[3][1]) >> (64 - 45)));
    E[4][2] ^= D[2];
    B[1][4] = (((E[4][2]) << 61) ^ ((E[4][2]) >> (64 - 61)));
    A[1][0] = B[1][0] ^ ((~B[1][1]) & B[1][2]);
    C[0] ^= A[1][0];
    A[1][1] = B[1][1] ^ ((~B[1][2]) & B[1][3]);
    C[1] ^= A[1][1];
    A[1][2] = B[1][2] ^ ((~B[1][3]) & B[1][4]);
    C[2] ^= A[1][2];
    A[1][3] = B[1][3] ^ ((~B[1][4]) & B[1][0]);
    C[3] ^= A[1][3];
    A[1][4] = B[1][4] ^ ((~B[1][0]) & B[1][1]);
    C[4] ^= A[1][4];
    E[0][1] ^= D[1];
    B[2][0] = (((E[0][1]) << 1) ^ ((E[0][1]) >> (64 - 1)));
    E[1][2] ^= D[2];
    B[2][1] = (((E[1][2]) << 6) ^ ((E[1][2]) >> (64 - 6)));
    E[2][3] ^= D[3];
    B[2][2] = (((E[2][3]) << 25) ^ ((E[2][3]) >> (64 - 25)));
    E[3][4] ^= D[4];
    B[2][3] = (((E[3][4]) << 8) ^ ((E[3][4]) >> (64 - 8)));
    E[4][0] ^= D[0];
    B[2][4] = (((E[4][0]) << 18) ^ ((E[4][0]) >> (64 - 18)));
    A[2][0] = B[2][0] ^ ((~B[2][1]) & B[2][2]);
    C[0] ^= A[2][0];
    A[2][1] = B[2][1] ^ ((~B[2][2]) & B[2][3]);
    C[1] ^= A[2][1];
    A[2][2] = B[2][2] ^ ((~B[2][3]) & B[2][4]);
    C[2] ^= A[2][2];
    A[2][3] = B[2][3] ^ ((~B[2][4]) & B[2][0]);
    C[3] ^= A[2][3];
    A[2][4] = B[2][4] ^ ((~B[2][0]) & B[2][1]);
    C[4] ^= A[2][4];
    E[0][4] ^= D[4];
    B[3][0] = (((E[0][4]) << 27) ^ ((E[0][4]) >> (64 - 27)));
    E[1][0] ^= D[0];
    B[3][1] = (((E[1][0]) << 36) ^ ((E[1][0]) >> (64 - 36)));
    E[2][1] ^= D[1];
    B[3][2] = (((E[2][1]) << 10) ^ ((E[2][1]) >> (64 - 10)));
    E[3][2] ^= D[2];
    B[3][3] = (((E[3][2]) << 15) ^ ((E[3][2]) >> (64 - 15)));
    E[4][3] ^= D[3];
    B[3][4] = (((E[4][3]) << 56) ^ ((E[4][3]) >> (64 - 56)));
    A[3][0] = B[3][0] ^ ((~B[3][1]) & B[3][2]);
    C[0] ^= A[3][0];
    A[3][1] = B[3][1] ^ ((~B[3][2]) & B[3][3]);
    C[1] ^= A[3][1];
    A[3][2] = B[3][2] ^ ((~B[3][3]) & B[3][4]);
    C[2] ^= A[3][2];
    A[3][3] = B[3][3] ^ ((~B[3][4]) & B[3][0]);
    C[3] ^= A[3][3];
    A[3][4] = B[3][4] ^ ((~B[3][0]) & B[3][1]);
    C[4] ^= A[3][4];
    E[0][2] ^= D[2];
    B[4][0] = (((E[0][2]) << 62) ^ ((E[0][2]) >> (64 - 62)));
    E[1][3] ^= D[3];
    B[4][1] = (((E[1][3]) << 55) ^ ((E[1][3]) >> (64 - 55)));
    E[2][4] ^= D[4];
    B[4][2] = (((E[2][4]) << 39) ^ ((E[2][4]) >> (64 - 39)));
    E[3][0] ^= D[0];
    B[4][3] = (((E[3][0]) << 41) ^ ((E[3][0]) >> (64 - 41)));
    E[4][1] ^= D[1];
    B[4][4] = (((E[4][1]) << 2) ^ ((E[4][1]) >> (64 - 2)));
    A[4][0] = B[4][0] ^ ((~B[4][1]) & B[4][2]);
    C[0] ^= A[4][0];
    A[4][1] = B[4][1] ^ ((~B[4][2]) & B[4][3]);
    C[1] ^= A[4][1];
    A[4][2] = B[4][2] ^ ((~B[4][3]) & B[4][4]);
    C[2] ^= A[4][2];
    A[4][3] = B[4][3] ^ ((~B[4][4]) & B[4][0]);
    C[3] ^= A[4][3];
    A[4][4] = B[4][4] ^ ((~B[4][0]) & B[4][1]);
    C[4] ^= A[4][4];
    D[0] = C[4] ^ (((C[1]) << 1) ^ ((C[1]) >> (64 - 1)));
    D[1] = C[0] ^ (((C[2]) << 1) ^ ((C[2]) >> (64 - 1)));
    D[2] = C[1] ^ (((C[3]) << 1) ^ ((C[3]) >> (64 - 1)));
    D[3] = C[2] ^ (((C[4]) << 1) ^ ((C[4]) >> (64 - 1)));
    D[4] = C[3] ^ (((C[0]) << 1) ^ ((C[0]) >> (64 - 1)));
    A[0][0] ^= D[0];
    B[0][0] = A[0][0];
    A[1][1] ^= D[1];
    B[0][1] = (((A[1][1]) << 44) ^ ((A[1][1]) >> (64 - 44)));
    A[2][2] ^= D[2];
    B[0][2] = (((A[2][2]) << 43) ^ ((A[2][2]) >> (64 - 43)));
    A[3][3] ^= D[3];
    B[0][3] = (((A[3][3]) << 21) ^ ((A[3][3]) >> (64 - 21)));
    A[4][4] ^= D[4];
    B[0][4] = (((A[4][4]) << 14) ^ ((A[4][4]) >> (64 - 14)));
    E[0][0] = B[0][0] ^ ((~B[0][1]) & B[0][2]);
    E[0][0] ^= KECCAKF1600_ROUND_CONSTANTS[22];
    C[0] = E[0][0];
    E[0][1] = B[0][1] ^ ((~B[0][2]) & B[0][3]);
    C[1] = E[0][1];
    E[0][2] = B[0][2] ^ ((~B[0][3]) & B[0][4]);
    C[2] = E[0][2];
    E[0][3] = B[0][3] ^ ((~B[0][4]) & B[0][0]);
    C[3] = E[0][3];
    E[0][4] = B[0][4] ^ ((~B[0][0]) & B[0][1]);
    C[4] = E[0][4];
    A[0][3] ^= D[3];
    B[1][0] = (((A[0][3]) << 28) ^ ((A[0][3]) >> (64 - 28)));
    A[1][4] ^= D[4];
    B[1][1] = (((A[1][4]) << 20) ^ ((A[1][4]) >> (64 - 20)));
    A[2][0] ^= D[0];
    B[1][2] = (((A[2][0]) << 3) ^ ((A[2][0]) >> (64 - 3)));
    A[3][1] ^= D[1];
    B[1][3] = (((A[3][1]) << 45) ^ ((A[3][1]) >> (64 - 45)));
    A[4][2] ^= D[2];
    B[1][4] = (((A[4][2]) << 61) ^ ((A[4][2]) >> (64 - 61)));
    E[1][0] = B[1][0] ^ ((~B[1][1]) & B[1][2]);
    C[0] ^= E[1][0];
    E[1][1] = B[1][1] ^ ((~B[1][2]) & B[1][3]);
    C[1] ^= E[1][1];
    E[1][2] = B[1][2] ^ ((~B[1][3]) & B[1][4]);
    C[2] ^= E[1][2];
    E[1][3] = B[1][3] ^ ((~B[1][4]) & B[1][0]);
    C[3] ^= E[1][3];
    E[1][4] = B[1][4] ^ ((~B[1][0]) & B[1][1]);
    C[4] ^= E[1][4];
    A[0][1] ^= D[1];
    B[2][0] = (((A[0][1]) << 1) ^ ((A[0][1]) >> (64 - 1)));
    A[1][2] ^= D[2];
    B[2][1] = (((A[1][2]) << 6) ^ ((A[1][2]) >> (64 - 6)));
    A[2][3] ^= D[3];
    B[2][2] = (((A[2][3]) << 25) ^ ((A[2][3]) >> (64 - 25)));
    A[3][4] ^= D[4];
    B[2][3] = (((A[3][4]) << 8) ^ ((A[3][4]) >> (64 - 8)));
    A[4][0] ^= D[0];
    B[2][4] = (((A[4][0]) << 18) ^ ((A[4][0]) >> (64 - 18)));
    E[2][0] = B[2][0] ^ ((~B[2][1]) & B[2][2]);
    C[0] ^= E[2][0];
    E[2][1] = B[2][1] ^ ((~B[2][2]) & B[2][3]);
    C[1] ^= E[2][1];
    E[2][2] = B[2][2] ^ ((~B[2][3]) & B[2][4]);
    C[2] ^= E[2][2];
    E[2][3] = B[2][3] ^ ((~B[2][4]) & B[2][0]);
    C[3] ^= E[2][3];
    E[2][4] = B[2][4] ^ ((~B[2][0]) & B[2][1]);
    C[4] ^= E[2][4];
    A[0][4] ^= D[4];
    B[3][0] = (((A[0][4]) << 27) ^ ((A[0][4]) >> (64 - 27)));
    A[1][0] ^= D[0];
    B[3][1] = (((A[1][0]) << 36) ^ ((A[1][0]) >> (64 - 36)));
    A[2][1] ^= D[1];
    B[3][2] = (((A[2][1]) << 10) ^ ((A[2][1]) >> (64 - 10)));
    A[3][2] ^= D[2];
    B[3][3] = (((A[3][2]) << 15) ^ ((A[3][2]) >> (64 - 15)));
    A[4][3] ^= D[3];
    B[3][4] = (((A[4][3]) << 56) ^ ((A[4][3]) >> (64 - 56)));
    E[3][0] = B[3][0] ^ ((~B[3][1]) & B[3][2]);
    C[0] ^= E[3][0];
    E[3][1] = B[3][1] ^ ((~B[3][2]) & B[3][3]);
    C[1] ^= E[3][1];
    E[3][2] = B[3][2] ^ ((~B[3][3]) & B[3][4]);
    C[2] ^= E[3][2];
    E[3][3] = B[3][3] ^ ((~B[3][4]) & B[3][0]);
    C[3] ^= E[3][3];
    E[3][4] = B[3][4] ^ ((~B[3][0]) & B[3][1]);
    C[4] ^= E[3][4];
    A[0][2] ^= D[2];
    B[4][0] = (((A[0][2]) << 62) ^ ((A[0][2]) >> (64 - 62)));
    A[1][3] ^= D[3];
    B[4][1] = (((A[1][3]) << 55) ^ ((A[1][3]) >> (64 - 55)));
    A[2][4] ^= D[4];
    B[4][2] = (((A[2][4]) << 39) ^ ((A[2][4]) >> (64 - 39)));
    A[3][0] ^= D[0];
    B[4][3] = (((A[3][0]) << 41) ^ ((A[3][0]) >> (64 - 41)));
    A[4][1] ^= D[1];
    B[4][4] = (((A[4][1]) << 2) ^ ((A[4][1]) >> (64 - 2)));
    E[4][0] = B[4][0] ^ ((~B[4][1]) & B[4][2]);
    C[0] ^= E[4][0];
    E[4][1] = B[4][1] ^ ((~B[4][2]) & B[4][3]);
    C[1] ^= E[4][1];
    E[4][2] = B[4][2] ^ ((~B[4][3]) & B[4][4]);
    C[2] ^= E[4][2];
    E[4][3] = B[4][3] ^ ((~B[4][4]) & B[4][0]);
    C[3] ^= E[4][3];
    E[4][4] = B[4][4] ^ ((~B[4][0]) & B[4][1]);
    C[4] ^= E[4][4];
    D[0] = C[4] ^ (((C[1]) << 1) ^ ((C[1]) >> (64 - 1)));
    D[1] = C[0] ^ (((C[2]) << 1) ^ ((C[2]) >> (64 - 1)));
    D[2] = C[1] ^ (((C[3]) << 1) ^ ((C[3]) >> (64 - 1)));
    D[3] = C[2] ^ (((C[4]) << 1) ^ ((C[4]) >> (64 - 1)));
    D[4] = C[3] ^ (((C[0]) << 1) ^ ((C[0]) >> (64 - 1)));
    E[0][0] ^= D[0];
    B[0][0] = E[0][0];
    E[1][1] ^= D[1];
    B[0][1] = (((E[1][1]) << 44) ^ ((E[1][1]) >> (64 - 44)));
    E[2][2] ^= D[2];
    B[0][2] = (((E[2][2]) << 43) ^ ((E[2][2]) >> (64 - 43)));
    E[3][3] ^= D[3];
    B[0][3] = (((E[3][3]) << 21) ^ ((E[3][3]) >> (64 - 21)));
    E[4][4] ^= D[4];
    B[0][4] = (((E[4][4]) << 14) ^ ((E[4][4]) >> (64 - 14)));
    A[0][0] = B[0][0] ^ ((~B[0][1]) & B[0][2]);
    A[0][0] ^= KECCAKF1600_ROUND_CONSTANTS[23];
    A[0][1] = B[0][1] ^ ((~B[0][2]) & B[0][3]);
    A[0][2] = B[0][2] ^ ((~B[0][3]) & B[0][4]);
    A[0][3] = B[0][3] ^ ((~B[0][4]) & B[0][0]);
    A[0][4] = B[0][4] ^ ((~B[0][0]) & B[0][1]);
    E[0][3] ^= D[3];
    B[1][0] = (((E[0][3]) << 28) ^ ((E[0][3]) >> (64 - 28)));
    E[1][4] ^= D[4];
    B[1][1] = (((E[1][4]) << 20) ^ ((E[1][4]) >> (64 - 20)));
    E[2][0] ^= D[0];
    B[1][2] = (((E[2][0]) << 3) ^ ((E[2][0]) >> (64 - 3)));
    E[3][1] ^= D[1];
    B[1][3] = (((E[3][1]) << 45) ^ ((E[3][1]) >> (64 - 45)));
    E[4][2] ^= D[2];
    B[1][4] = (((E[4][2]) << 61) ^ ((E[4][2]) >> (64 - 61)));
    A[1][0] = B[1][0] ^ ((~B[1][1]) & B[1][2]);
    A[1][1] = B[1][1] ^ ((~B[1][2]) & B[1][3]);
    A[1][2] = B[1][2] ^ ((~B[1][3]) & B[1][4]);
    A[1][3] = B[1][3] ^ ((~B[1][4]) & B[1][0]);
    A[1][4] = B[1][4] ^ ((~B[1][0]) & B[1][1]);
    E[0][1] ^= D[1];
    B[2][0] = (((E[0][1]) << 1) ^ ((E[0][1]) >> (64 - 1)));
    E[1][2] ^= D[2];
    B[2][1] = (((E[1][2]) << 6) ^ ((E[1][2]) >> (64 - 6)));
    E[2][3] ^= D[3];
    B[2][2] = (((E[2][3]) << 25) ^ ((E[2][3]) >> (64 - 25)));
    E[3][4] ^= D[4];
    B[2][3] = (((E[3][4]) << 8) ^ ((E[3][4]) >> (64 - 8)));
    E[4][0] ^= D[0];
    B[2][4] = (((E[4][0]) << 18) ^ ((E[4][0]) >> (64 - 18)));
    A[2][0] = B[2][0] ^ ((~B[2][1]) & B[2][2]);
    A[2][1] = B[2][1] ^ ((~B[2][2]) & B[2][3]);
    A[2][2] = B[2][2] ^ ((~B[2][3]) & B[2][4]);
    A[2][3] = B[2][3] ^ ((~B[2][4]) & B[2][0]);
    A[2][4] = B[2][4] ^ ((~B[2][0]) & B[2][1]);
    E[0][4] ^= D[4];
    B[3][0] = (((E[0][4]) << 27) ^ ((E[0][4]) >> (64 - 27)));
    E[1][0] ^= D[0];
    B[3][1] = (((E[1][0]) << 36) ^ ((E[1][0]) >> (64 - 36)));
    E[2][1] ^= D[1];
    B[3][2] = (((E[2][1]) << 10) ^ ((E[2][1]) >> (64 - 10)));
    E[3][2] ^= D[2];
    B[3][3] = (((E[3][2]) << 15) ^ ((E[3][2]) >> (64 - 15)));
    E[4][3] ^= D[3];
    B[3][4] = (((E[4][3]) << 56) ^ ((E[4][3]) >> (64 - 56)));
    A[3][0] = B[3][0] ^ ((~B[3][1]) & B[3][2]);
    A[3][1] = B[3][1] ^ ((~B[3][2]) & B[3][3]);
    A[3][2] = B[3][2] ^ ((~B[3][3]) & B[3][4]);
    A[3][3] = B[3][3] ^ ((~B[3][4]) & B[3][0]);
    A[3][4] = B[3][4] ^ ((~B[3][0]) & B[3][1]);
    E[0][2] ^= D[2];
    B[4][0] = (((E[0][2]) << 62) ^ ((E[0][2]) >> (64 - 62)));
    E[1][3] ^= D[3];
    B[4][1] = (((E[1][3]) << 55) ^ ((E[1][3]) >> (64 - 55)));
    E[2][4] ^= D[4];
    B[4][2] = (((E[2][4]) << 39) ^ ((E[2][4]) >> (64 - 39)));
    E[3][0] ^= D[0];
    B[4][3] = (((E[3][0]) << 41) ^ ((E[3][0]) >> (64 - 41)));
    E[4][1] ^= D[1];
    B[4][4] = (((E[4][1]) << 2) ^ ((E[4][1]) >> (64 - 2)));
    A[4][0] = B[4][0] ^ ((~B[4][1]) & B[4][2]);
    A[4][1] = B[4][1] ^ ((~B[4][2]) & B[4][3]);
    A[4][2] = B[4][2] ^ ((~B[4][3]) & B[4][4]);
    A[4][3] = B[4][3] ^ ((~B[4][4]) & B[4][0]);
    A[4][4] = B[4][4] ^ ((~B[4][0]) & B[4][1]);
}

} // namespace cartesi

#endif // KECCAKF_H
